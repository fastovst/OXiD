!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),o={getCurrentColor:function(t,o){var e;return t.dom.getParents(t.selection.getStart(),function(t){var r;(r=t.style["forecolor"===o?"color":"background-color"])&&(e=e||r)}),e},mapColors:function(t){var o,e=[];for(o=0;o<t.length;o+=2)e.push({text:t[o+1],color:"#"+t[o]});return e},applyFormat:function(t,o,e){t.undoManager.transact(function(){t.focus(),t.formatter.apply(o,{value:e}),t.nodeChanged()})},removeFormat:function(t,o){t.undoManager.transact(function(){t.focus(),t.formatter.remove(o,{value:null},null,!0),t.nodeChanged()})}},e={register:function(t){t.addCommand("mceApplyTextcolor",function(e,r){o.applyFormat(t,e,r)}),t.addCommand("mceRemoveTextcolor",function(e){o.removeFormat(t,e)})}},r=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),l=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=["000000","Black","993300","Burnt orange","333300","Dark olive","003300","Dark green","003366","Dark azure","000080","Navy Blue","333399","Indigo","333333","Very dark gray","800000","Maroon","FF6600","Orange","808000","Olive","008000","Green","008080","Teal","0000FF","Blue","666699","Grayish blue","808080","Gray","FF0000","Red","FF9900","Amber","99CC00","Yellow green","339966","Sea green","33CCCC","Turquoise","3366FF","Royal blue","800080","Purple","999999","Medium gray","FF00FF","Magenta","FFCC00","Gold","FFFF00","Yellow","00FF00","Lime","00FFFF","Aqua","00CCFF","Sky blue","993366","Red violet","FFFFFF","White","FF99CC","Pink","FFCC99","Peach","FFFF99","Light yellow","CCFFCC","Pale green","CCFFFF","Pale cyan","99CCFF","Light sky blue","CC99FF","Plum"],a=function(t){return t.getParam("textcolor_map",n)},c=function(t){return t.getParam("textcolor_rows",5)},i=function(t){return t.getParam("textcolor_cols",8)},u=function(t){return t.getParam("color_picker_callback",null)},s={getForeColorMap:function(t){return t.getParam("forecolor_map",a(t))},getBackColorMap:function(t){return t.getParam("backcolor_map",a(t))},getForeColorRows:function(t){return t.getParam("forecolor_rows",c(t))},getBackColorRows:function(t){return t.getParam("backcolor_rows",c(t))},getForeColorCols:function(t){return t.getParam("forecolor_cols",i(t))},getBackColorCols:function(t){return t.getParam("backcolor_cols",i(t))},getColorPickerCallback:u,hasColorPicker:function(t){return"function"==typeof u(t)}},m=tinymce.util.Tools.resolve("tinymce.util.I18n"),g={getHtml:function(t,e,l,n){var a,c,i,u,s,g,d,C=0,f=r.DOM.uniqueId("mcearia"),F=function(t,o){var e="transparent"===t;return'<td class="mce-grid-cell'+(e?" mce-colorbtn-trans":"")+'"><div id="'+f+"-"+C+++'" data-mce-color="'+(t||"")+'" role="option" tabIndex="-1" style="'+(t?"background-color: "+t:"")+'" title="'+m.translate(o)+'">'+(e?"&#215;":"")+"</div></td>"};for((a=o.mapColors(l)).push({text:m.translate("No color"),color:"transparent"}),i='<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>',u=a.length-1,g=0;g<e;g++){for(i+="<tr>",s=0;s<t;s++)i+=(d=g*t+s)>u?"<td></td>":F((c=a[d]).color,c.text);i+="</tr>"}if(n){for(i+='<tr><td colspan="'+t+'" class="mce-custom-color-btn"><div id="'+f+'-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="'+f+'-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">'+m.translate("Custom...")+"</button></div></td></tr>",i+="<tr>",s=0;s<t;s++)i+=F("","Custom color");i+="</tr>"}return i+="</tbody></table>"}},d=function(t,o){t.style.background=o,t.setAttribute("data-mce-color",o)},C=function(t){return function(o){var e=o.control;e._color?t.execCommand("mceApplyTextcolor",e.settings.format,e._color):t.execCommand("mceRemoveTextcolor",e.settings.format)}},f=function(t,e){return function(n){var a,c=this.parent(),i=o.getCurrentColor(t,c.settings.format),u=function(o){t.execCommand("mceApplyTextcolor",c.settings.format,o),c.hidePanel(),c.color(o)};r.DOM.getParent(n.target,".mce-custom-color-btn")&&(c.hidePanel(),s.getColorPickerCallback(t).call(t,function(t){var o,r,n,a=c.panel.getEl().getElementsByTagName("table")[0];for(o=l.map(a.rows[a.rows.length-1].childNodes,function(t){return t.firstChild}),n=0;n<o.length&&(r=o[n]).getAttribute("data-mce-color");n++);if(n===e)for(n=0;n<e-1;n++)d(o[n],o[n+1].getAttribute("data-mce-color"));d(r,t),u(t)},i)),(a=n.target.getAttribute("data-mce-color"))?(this.lastId&&r.DOM.get(this.lastId).setAttribute("aria-selected","false"),n.target.setAttribute("aria-selected",!0),this.lastId=n.target.id,"transparent"===a?(t.execCommand("mceRemoveTextcolor",c.settings.format),c.hidePanel(),c.resetColor()):u(a)):null!==a&&c.hidePanel()}},F=function(t,o){return function(){var e=o?s.getForeColorCols(t):s.getBackColorCols(t),r=o?s.getForeColorRows(t):s.getBackColorRows(t),l=o?s.getForeColorMap(t):s.getBackColorMap(t),n=s.hasColorPicker(t);return g.getHtml(e,r,l,n)}},b={register:function(t){t.addButton("forecolor",{type:"colorbutton",tooltip:"Text color",format:"forecolor",panel:{role:"application",ariaRemember:!0,html:F(t,!0),onclick:f(t,s.getForeColorCols(t))},onclick:C(t)}),t.addButton("backcolor",{type:"colorbutton",tooltip:"Background color",format:"hilitecolor",panel:{role:"application",ariaRemember:!0,html:F(t,!1),onclick:f(t,s.getBackColorCols(t))},onclick:C(t)})}};t.add("textcolor",function(t){e.register(t),b.register(t)})}();