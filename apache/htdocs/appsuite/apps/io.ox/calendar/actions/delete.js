define("io.ox/calendar/actions/delete",["io.ox/calendar/api","io.ox/calendar/util","io.ox/core/yell","gettext!io.ox/calendar","io.ox/backbone/views/modal","io.ox/backbone/mini-views/common"],function(e,t,n,a,o,i){"use strict";return function(r){e.getList(r).done(function(r){var l,s=_(r).every(function(e){return(e.hasFlag("organizer")||e.hasFlag("organizer_on_behalf")&&!e.hasFlag("attendee"))&&e.hasFlag("scheduled")}),c=new Backbone.Model({comment:""}),d=[$("<label>").text(a("Add a message to the notification email for the other participants.")).attr({for:l=_.uniqueId("containerlabel-")}),new i.InputView({name:"comment",model:c,placeholder:a("Password"),autocomplete:!1}).render().$el];d[1].find("input").attr("id",l);var u,p,m,f=function(a){r=_(r).chain().map(function(e){e=e instanceof Backbone.Model?e.attributes:e;var t={id:"thisandfuture"===a||"series"===a?e.seriesId||e.id:e.id,folder:e.folder,recurrenceRange:"thisandfuture"===a?"THISANDFUTURE":void 0};return"series"!==a&&e.recurrenceId&&(t.recurrenceId=e.recurrenceId),t}).uniq(function(e){return JSON.stringify(e)}).value();var o=t.getCurrentRangeOptions();s&&c.get("comment")&&(o.comment=c.get("comment")),e.remove(r,o).fail(n)},h=_(r).some(function(e){return!e.hasFlag("last_occurrence")&&e.has("recurrenceId")});h?(m=_(r).some(function(e){return e.hasFlag("first_occurrence")||!e.hasFlag("organizer")}),u=a(m?"This appointment is part of a series. Do you want to delete all appointments of the series or just this appointment?":"This appointment is part of a series. Do you want to delete this and all future appointments of the series or just this appointment?")):u=a("Do you really want to delete this appointment?"),(p=new o({title:a("Delete appointment"),width:600,description:s?_([$("<div>").text(u),d]).flatten():$("<div>").text(u)}).addCancelButton({left:!0}).on("action",function(e){"cancel"!==e&&f(e)})).$el.addClass("delete-dialog"),h?(p.addButton({label:a("Delete this appointment"),action:"appointment",className:"btn-default"}),m?p.addButton({label:a("Delete all appointments"),action:"series"}):p.addButton({label:a("Delete all future appointments"),action:"thisandfuture"})):p.addButton({label:a("Delete appointment"),action:"appointment"}),p.open()})}});