define("io.ox/calendar/mobile-toolbar-actions",["io.ox/core/extensions","io.ox/backbone/views/toolbar","io.ox/backbone/views/actions/mobile","io.ox/calendar/api","io.ox/calendar/util","gettext!io.ox/calendar","io.ox/calendar/actions"],function(e,i,o,a,t,n){"use strict";function l(e){var i="list"===e.pages.getCurrentPage().name?e.listView.selection.get():[];i=_(i).map(function(i){return _.isString(i)&&(i=_.extend(t.cid(i),{flags:e.listView.selection.getNode(i).attr("data-flags")||""})),i}),e.updateToolbar(i)}var r={create:{prio:"hi",mobile:"hi",title:n("Create"),icon:"fa fa-plus",drawDisabled:!0,ref:"io.ox/calendar/detail/actions/create"},listView:{prio:"hi",mobile:"hi",title:n("List view"),icon:"fa fa-list",drawDisabled:!0,ref:"io.ox/calendar/actions/switch-to-list-view"},calendarView:{prio:"hi",mobile:"hi",title:n("Calendar view"),icon:"fa fa-table",drawDisabled:!0,ref:"io.ox/calendar/actions/switch-to-month-view"},next:{prio:"hi",mobile:"hi",title:n("Show next month"),icon:"fa fa-chevron-right",drawDisabled:!0,ref:"io.ox/calendar/actions/showNext"},prev:{prio:"hi",mobile:"hi",title:n("Show previous month"),icon:"fa fa-chevron-left",drawDisabled:!0,ref:"io.ox/calendar/actions/showPrevious"},today:{prio:"hi",mobile:"hi",title:n("Today"),drawDisabled:!0,ref:"io.ox/calendar/actions/showToday"},move:{prio:"hi",mobile:"hi",title:n("Move"),icon:"fa fa-sign-in",drawDisabled:!0,ref:"io.ox/calendar/detail/actions/move"},delete:{prio:"hi",mobile:"hi",title:n("Delete"),icon:"fa fa-trash-o",drawDisabled:!0,ref:"io.ox/calendar/detail/actions/delete"},export:{prio:"hi",mobile:"hi",title:n("Export"),drawDisabled:!0,ref:"io.ox/calendar/detail/actions/export"}},c={monthView:"io.ox/calendar/mobile/toolbar/month",weekView:"io.ox/calendar/mobile/toolbar/week",listView:"io.ox/calendar/mobile/toolbar/list",listViewMulti:"io.ox/calendar/mobile/toolbar/list/multiselect",detailView:"io.ox/calendar/mobile/toolbar/detailView"};e.point(c.detailView+"/links").extend(e.point("io.ox/calendar/links/inline").list().map(function(e){switch((e=_(e).pick("id","index","prio","mobile","icon","title","ref","section","sectionTitle")).id){case"edit":e.icon="fa fa-pencil";break;case"accept":e.mobile="hi",e.icon="fa fa-check";break;case"decline":e.mobile="lo";break;case"delete":e.mobile="hi",e.icon="fa fa-trash";break;case"send mail":e.mobile="hi",e.icon="fa fa-envelope-o"}return e})),o.addAction(c.monthView,r,["create","listView","prev","today","next"]),o.addAction(c.weekView,r,["create","listView","prev","today","next"]),o.addAction(c.listView,r,["calendarView"]),o.addAction(c.listViewMulti,r,["move","delete"]),o.createToolbarExtensions(c);var d=_.debounce(function(i){if(i){i=1===i.length?i[0]:i;var o=e.Baton({data:i,app:this});this.pages.getToolbar("month").setBaton(o),this.pages.getToolbar("week:day").setBaton(o),this.pages.getToolbar("list").setBaton(o),this.pages.getSecondaryToolbar("list").setBaton(o)}},10);e.point("io.ox/calendar/mediator").extend({id:"toolbar-mobile",index:10100,setup:function(e){_.device("!smartphone")||(e.updateToolbar=d)}}),e.point("io.ox/calendar/mediator").extend({id:"update-toolbar-mobile",index:10300,setup:function(e){_.device("!smartphone")||(e.updateToolbar([]),e.listView.on("selection:change",function(){l(e)}),e.on("folder:change",function(){l(e)}),e.getWindow().on("change:perspective change:initialPerspective",function(){_.defer(l,e)}))}}),e.point("io.ox/calendar/mediator").extend({id:"change-mode-toolbar-mobile",index:10400,setup:function(e){_.device("smartphone")&&e.props.on("change:checkboxes",function(i,o){e.pages.toggleSecondaryToolbar("list",o)})}})});