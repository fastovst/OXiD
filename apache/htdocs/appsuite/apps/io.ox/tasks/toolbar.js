define("io.ox/tasks/toolbar",["io.ox/core/extensions","io.ox/backbone/mini-views/dropdown","io.ox/backbone/views/toolbar","io.ox/core/tk/upload","io.ox/core/dropzone","io.ox/core/notifications","io.ox/tasks/common-extensions","io.ox/tasks/api","gettext!io.ox/tasks","io.ox/tasks/actions","less!io.ox/tasks/style"],function(o,e,t,i,a,n,s,r,l){"use strict";if(!_.device("smartphone")){var d=o.point("io.ox/tasks/toolbar/links"),p={create:{prio:"hi",mobile:"hi",title:l("New task"),drawDisabled:!0,ref:"io.ox/tasks/actions/create"},edit:{prio:"hi",mobile:"hi",title:l("Edit"),tooltip:l("Edit task"),drawDisabled:!0,ref:"io.ox/tasks/actions/edit"},"change-due-date":{prio:"hi",mobile:"lo",title:l("Due"),tooltip:l("Change due date"),ref:"io.ox/tasks/actions/placeholder",customize:s.dueDate},done:{prio:"hi",mobile:"hi",title:l("Done"),tooltip:l("Mark as done"),ref:"io.ox/tasks/actions/done"},undone:{prio:"hi",mobile:"hi",title:l("Undone"),tooltip:l("Mark as undone"),ref:"io.ox/tasks/actions/undone"},delete:{prio:"hi",mobile:"hi",title:l("Delete"),tooltip:l("Delete task"),ref:"io.ox/tasks/actions/delete"},export:{prio:"lo",mobile:"lo",title:l("Export"),drawDisabled:!0,ref:"io.ox/tasks/actions/export"},confirm:{prio:"lo",mobile:"lo",title:l("Change confirmation status"),ref:"io.ox/tasks/actions/confirm"},print:{prio:"lo",mobile:"lo",title:l("Print"),drawDisabled:!0,ref:"io.ox/tasks/actions/print"},move:{prio:"lo",mobile:"lo",title:l("Move"),ref:"io.ox/tasks/actions/move",drawDisabled:!0,section:"file-op"}},c=0;_(p).each(function(o,e){o.id=e,o.index=c+=100,d.extend(o)}),o.point("io.ox/tasks/toolbar/links").extend({id:"view-dropdown",index:1e4,custom:!0,draw:function(o){new e({el:this,caret:!0,model:o.app.props,label:l("View")}).group(l("Options")).option("folderview",!0,l("Folder view"),{group:!0}).option("checkboxes",!0,l("Checkboxes"),{group:!0}).render().$el.addClass("pull-right dropdown").attr("data-dropdown","view")}}),o.point("io.ox/tasks/mediator").extend({id:"toolbar",index:1e4,setup:function(o){var e=new t({point:"io.ox/tasks/toolbar/links",title:o.getTitle(),strict:!1});o.getWindow().nodes.body.addClass("classic-toolbar-visible").prepend(e.$el),o.updateToolbar=function(o){var t={data:[],folder_id:this.folder.get(),app:this};e.setSelection(o,function(){return o.length?(o.length<=100?r.getList(o):$.when(o)).pipe(function(o){return t.data=o,t}):t})},o.forceUpdateToolbar=function(o){e.selection=null,this.updateToolbar(o)}}}),o.point("io.ox/tasks/mediator").extend({id:"update-toolbar",index:10200,setup:function(o){o.updateToolbar([]),o.getGrid().selection.on("change",function(e,t){o.updateToolbar(t)}),r.on("update",function(){o.forceUpdateToolbar(o.getGrid().selection.get())})}})}});