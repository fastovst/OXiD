define("io.ox/files/actions/restore",["io.ox/core/folder/api","io.ox/files/api","io.ox/core/notifications","gettext!io.ox/files"],function(n,e,o,t){"use strict";function i(e){var o=new $.Deferred;return n.path(e).done(function(n){var e=_(n).pluck("title").join("/");f.push(e),o.resolve(e)}),o.promise()}function r(n){_.each(n,function(n){if(_.isArray(n.path)){var e=n.path[0];_.contains(c,e.id)||c.push(e.id)}}),_.each(c,function(n){s.push(i(n))}),$.when.apply($,s).done(function(){return f.length>1?o.yell("info",t("Restored into multiple folders:\n\n%s",f.join("\n"))):o.yell("info",t("Restored into folder:\n\n%s",f.join("\n")))})}var f,c,s;return function(o){f=[],s=[],c=[],_.isArray(o)||(o=[o]);var t=_.filter(o,function(n){return"folder"===n.get("folder_id")}),i=_(o).difference(t);t.length&&i.length?n.restore(t).done(function(n){e.restore(i).done(function(e){r(n.concat(e))})}):t.length?n.restore(t).done(function(n){r(n)}):i.length&&e.restore(i).done(function(n){r(n)})}});