define("io.ox/files/actions",["io.ox/core/folder/api","io.ox/files/api","io.ox/core/api/user","io.ox/files/share/api","io.ox/files/util","io.ox/core/api/filestorage","io.ox/core/extensions","io.ox/backbone/views/actions/util","io.ox/core/capabilities","io.ox/files/actions/download","settings!io.ox/files","settings!io.ox/core","gettext!io.ox/files","io.ox/core/yell"],function(e,i,o,t,n,r,s,l,a,c,d,f,u,p){"use strict";function m(i){var o,t;return i.app?o=i.app.folder.get():void 0!==i.folder_id?o=i.folder_id:i.data&&(o=i.data.folder_id),!!(t=e.pool.getModel(o))&&e.is("trash",t.toJSON())}function h(e){return"io.ox/mail/compose"===e.openedBy}function v(e){return _.isEmpty(e.data)}function x(e,i){return n.hasStatus(e,i.array())}function g(e){return!_.isEmpty(e.filename)||e.file_size>0}function w(e){return"localFile"!==e.group&&g(e)}function y(e){return _(e.first()).has("internal_userid")}function b(e,i){if(e){var o=_.map(i,function(e){return e.folder_id?_.cid(e):"folder."+e.id}),t=e.selection;if(_.intersection(o,t.get()).length){t.getPosition();var n=t.getItems().filter(".selected");t.dodge(),_(n).invoke("remove")}}}function k(i){var o=_.first(i.models).get("folder_id");return e.get(o).then(function(i){return!e.isExternalFileStorage(i)})}function F(e){var i=e.object_permissions||e["com.openexchange.share.extendedObjectPermissions"],t=_(i).findWhere({entity:ox.user_id});return(!t||t&&t.bits<2)&&_(i).findWhere({group:!0})?o.get().then(function(e){return!!((t=_(i).findWhere({entity:_(_.pluck(i,"entity")).intersection(e.groups)[0]}))&&t.bits>=2)},function(){return!1}):$.when(!!(t&&t.bits>=2))}function S(o,t,n){new L("io.ox/files/actions/"+o,{capabilities:"!guest && !anonymous",collection:"move"===o?"some && delete":"some && items && read",matches:function(e){return!h(e)&&(("move"!==o||!e.originFavorites)&&!x("lockedByOthers",e))},action:function(r){ox.load(["io.ox/files/actions/move-copy"]).done(function(s){var l=r.array();s(l,r,{type:o,fullResponse:!0,label:t,success:n,successCallback:function(t,s){if(_.isString(t))require(["io.ox/core/yell"],function(e){e("error",t),i.trigger("reload:listview")});else{var a={warnings:[]},c=[];_.isArray(t)||(t=[t]),_.each(t,function(e){var i=_.isString(e.error)?e:e.error;if(i){var t="FLD-1038"===i.code,n=0===i.code.indexOf("FILE_STORAGE"),r=_.isArray(i.warnings)?i.warnings:[i.warnings];"CONFLICT"===i.categories&&(n||t)&&(a.title||(a.title=i.error),t&&"move"===o&&!_(c).findWhere({id:i.error_params[1]})&&c.push(_(l).findWhere({id:i.error_params[1]})),!t&&"move"===o&&r&&_.each(r,function(e){_(c).findWhere({id:e.error_params[3]})||c.push(_(l).findWhere({id:e.error_params[3]}))}),r&&_.each(r,function(e){a.warnings.push(e.error)}),"copy"===o&&c.push(_(l).findWhere({id:i.error_params[1]})))}}),a.title&&c.length?require(["io.ox/core/tk/filestorageUtil"],function(t){t.displayConflicts(a,{callbackIgnoreConflicts:function(){i[o](c,r.target||s.target,!0).always(function(e){_.isString(e)?require(["io.ox/core/yell"],function(o){o("error",e),i.trigger("reload:listview")}):require(["io.ox/core/yell"],function(e){e("success",l.length>1?n.multiple:n.single)})})},callbackCancel:function(){var o=r.first().folder_id;o&&(e.reload(o),i.trigger("reload:listview"))}})}):require(["io.ox/core/yell"],function(e){e("success",l.length>1?n.multiple:n.single)})}}})})}})}function V(i,o){var t;if(o.collection.has("multiple"))return!1;if(y(o))return!1;if(o.collection.has("one")){var n=o.first();t=o.collection.has("folders")?n.id:n.folder_id}else o.app&&(t=o.app.folder.get());if(!t)return!1;var r=e.pool.getModel(t);return!!r.isShareable()&&(!r.is("trash")&&("invite"!==i||r.supportsInviteGuests()))}function E(e){var i=e.array();return _.isEmpty(i)&&(i=[{id:e.app.folder.get(),folder_id:"folder"}]),i}function M(e){return e.map(function(e){return"folder_name"in e?_.extend({},e,{folder_id:"folder"}):e})}var O=d.get("features/comments",!0),C=["csv","txt","js","css","md","tmpl","html"];a.has("guard")&&C.push("pgp");var L=l.Action;new L("io.ox/files/actions/upload",{folder:"create",matches:function(e){return!_(["14","15"]).contains(e.folder_id)&&!m(e)},action:function(e){var i,o=$(e.e.target);o.siblings("input").remove(),o.after(i=$('<input type="file" name="file" multiple>').css("display","none").on("change",function(o){var t=e.app;require(["io.ox/files/upload/main"],function(i){o.preventDefault();var n=[];_(o.target.files).each(function(e){n.push(_.extend(e,{group:"file"}))});var r=_.extend({folder:e.folder_id},e.file_options);i.setWindowNode(t.getWindowNode()),i.create.offer(n,r)}),i.remove()})),i.trigger("click")}}),new L("io.ox/files/actions/editor",{toggle:!!window.Blob,collection:"one && modify",matches:function(e){if(m(e))return!1;if(h(e))return!1;if(x("lockedByOthers",e))return!1;var o=e.first();if(!o.folder_id||!o.id)return!1;var t=_.first(e.models),n=t&&t.isEncrypted()?"\\.pgp":"",r=_.without(C,"pgp");return!!new RegExp("\\.("+r.join("|")+"?)"+n+"$","i").test(o.filename)&&i.versions.getCurrentState(o).then(function(e){return e})},action:function(e){var i=e.first(),o=function(o){ox.ui.App.reuse("io.ox/editor:edit."+_.cid(i))?e.context&&e.context.viewerEvents&&e.context.viewerEvents.trigger("viewer:close"):ox.launch("io.ox/editor/main",{folder:i.folder_id,id:i.id,params:_.extend({allowedFileExtensions:C},o)}).done(function(){e.context&&e.context.viewerEvents&&e.context.viewerEvents.trigger("viewer:close")})};a.has("guard")&&(i.meta&&i.meta.Encrypted||i.filename.toLowerCase().lastIndexOf(".pgp")===i.filename.length-4)?require(["io.ox/guard/auth/authorizer"],function(e){e.authorize().then(function(e){var i={cryptoAction:"Decrypt",cryptoAuth:e,session:ox.session};o(i)})}):o()}}),new L("io.ox/files/actions/editor-new",{toggle:!!window.Blob,folder:"create",matches:function(e){return!_(["14","15"]).contains(e.folder_id)&&(!m(e)&&!h(e))},action:function(e){ox.launch("io.ox/editor/main").done(function(){this.create({folder:e.app.folder.get(),params:{allowedFileExtensions:C}})})}}),new L("io.ox/files/actions/download",{device:"!ios || ios >= 12",collection:"some",matches:function(e){return e.collection.has("multiple")?e.array().every(w):!y(e)&&w(e.first())},action:function(e){c(e.array().map(function(e){var i=_.clone(e);return i.version=void 0,i}))}}),new L("io.ox/files/actions/download-folder",{device:"!ios || ios >= 12",collection:"one && folders",matches:function(e){return!r.isExternal(e.first())},action:function(e){require(["io.ox/files/api"],function(i){i.zip(e.first().id)})}}),new L("io.ox/files/actions/downloadversion",{device:"!ios || ios >= 12",matches:function(e){return!!e.collection.has("multiple")||g(e.first())},action:function(e){require(["io.ox/core/download"],function(i){_(e.array()).each(function(e){i.file(e)})})}}),new L("io.ox/files/actions/permissions",{device:"!smartphone",collection:"one",matches:function(i){var o=i.first(),t=i.collection.has("folders")?o.id:o.folder_id;return e.pool.getModel(t).isShareable()},action:function(e){require(["io.ox/files/share/permissions"],function(i){var o=e.models[0],t=e.first();o.isFile()?i.showFilePermissions(t):i.showFolderPermissions(t.id)})}}),new L("io.ox/files/actions/send",{collection:"some && items",matches:function(e){return!!a.has("webmail")&&(!v(e)&&(!h(e)&&(!m(e)&&e.array().reduce(function(e,i){return e||i.file_size>0},!1))))},action:function(e){var i=e.array().filter(function(e){return 0!==e.file_size});0!==i.length&&ox.registry.call("mail-compose","open",{attachments:i.map(function(e){return{origin:"drive",id:e.id,folder_id:e.folder_id}})})}}),new L("io.ox/files/actions/delete",{collection:"some && delete",matches:function(e){return!h(e)&&(!e.standalone&&!x("lockedByOthers",e))},action:function(e){ox.load(["io.ox/files/actions/delete"]).done(function(o){var t=e.array();e.models||(i.pool.add(t),e.models=i.pool.resolve(t)),o(e.models)})}}),new L("io.ox/files/actions/viewer",{collection:"some && items",matches:function(e){var o=e.first();return!e.isViewer&&((!1!==o.current_version||!i.isSpreadsheet(o))&&(!e.collection.has("guard")||a.has("guard")))},action:function(e){ox.load(["io.ox/core/viewer/main"]).done(function(i){var o=new i,t=e.array();t.length>1||!e.all?o.launch({files:t}):o.launch({selection:_(t).first(),files:e.all.models})})}}),new L("io.ox/files/actions/default",{action:function(e){l.invoke("io.ox/files/actions/viewer",e)}}),new L("io.ox/files/actions/lock",{capabilities:"!alone",device:"!smartphone",collection:"some && modify && items",matches:function(e){return!m(e)&&(!h(e)&&(!v(e)&&(!!x("!locked",e)&&k(e))))},action:function(e){ox.load(["io.ox/files/actions/lock-unlock"]).done(function(i){i.lock(e.array())})}}),new L("io.ox/files/actions/unlock",{capabilities:"!alone",device:"!smartphone",collection:"some && modify && items",matches:function(e){return!m(e)&&(!v(e)&&(!h(e)&&(!!x("locked",e)&&(!(!x("lockedByMe",e)&&!x("createdByMe",e))&&k(e)))))},action:function(e){ox.load(["io.ox/files/actions/lock-unlock"]).done(function(i){i.unlock(e.array())})}}),new L("io.ox/files/actions/add-to-portal",{capabilities:"portal",collection:"one && items",matches:function(e){return!v(e)&&(!m(e)&&!y(e))},action:function(e){ox.load(["io.ox/files/actions/add-to-portal"]).done(function(i){i(e.first())})}}),new L("io.ox/files/actions/rename",{collection:"one",matches:function(e){return!m(e)&&(!x("lockedByOthers",e)&&(!h(e)&&(e.collection.has("folders")?e.collection.has("rename:folder"):!!e.collection.has("modify")||F(e.first()))))},action:function(e){var i=e.first();"folder"===i.folder_id?ox.load(["io.ox/core/folder/actions/rename"]).done(function(e){e(i.id)}):ox.load(["io.ox/files/actions/rename"]).done(function(e){e(i)})}}),new L("io.ox/files/actions/save-as-pdf",{capabilities:"document_preview && !guest && !anonymous",collection:"one && items",matches:function(e){if(m(e))return!1;if(e.originFavorites)return!1;if(h(e))return!1;var i=e.models[0];return i.isFile()&&(i.isOffice()||i.isText())},action:function(e){ox.load(["io.ox/files/actions/save-as-pdf"]).done(function(i){i(e)})}}),new L("io.ox/files/actions/edit-description",{collection:"one && items",matches:function(i){return!m(i)&&(!h(i)&&(!x("lockedByOthers",i)&&(!!e.pool.getModel(i.first().folder_id).supports("extended_metadata")&&(!!i.collection.has("modify")||F(i.first())))))},action:function(e){ox.load(["io.ox/files/actions/edit-description"]).done(function(o){i.get(e.first()).done(function(e){o(e)})})}}),new L("io.ox/files/actions/upload-new-version",{toggle:O,collection:"one && modify && items",matches:function(i){if(h(i))return!1;if(x("lockedByOthers",i))return!1;var o=i.first(),t=e.pool.getModel(o.folder_id);return t&&t.can("add:version")},action:function(e){ox.load(["io.ox/files/actions/upload-new-version"]).done(function(i){i(e.first())})}}),new L("io.ox/files/actions/restore",{collection:"some",matches:function(i){if(v(i))return!1;var o=String(d.get("folder/trash"));return i.array().every(function(t){var n=t.folder_id;return/^folder\./.test(i.first().cid)&&(n=e.pool.getModel(i.first().id).get("folder_id")),o===n})},action:function(e){ox.load(["io.ox/files/actions/restore"]).done(function(o){var t=[];_.each(e.array(),function(o){var n=new i.Model(o),r=e.app.listView.getCompositeKey(n),s=i.resolve([r],!1);s.length&&t.push(s[0])}),o(t)})}}),S("move",u("Move"),{single:u("File has been moved"),multiple:u("Files have been moved")}),S("copy",u("Copy"),{single:u("File has been copied"),multiple:u("Files have been copied")}),new L("io.ox/files/actions/editShare",{matches:function(e){return!!e.app&&(!!e.app.mysharesListView&&(!!e.app.mysharesListView.$el&&1===e.app.mysharesListView.selection.get().length))},action:function(e){ox.load(["io.ox/files/actions/share"]).done(function(i){var o,t,n=_.isArray(e.models)?e.models:[e.models];n&&n.length&&(t=e.app.mysharesListView.$el.find(".list-item.selected")).length&&("invited-people"===(o=t.attr("data-share-type"))?i.invite(n):"public-link"===o&&i.link(n))})}}),new L("io.ox/files/actions/invite",{capabilities:"invite_guests",collection:"!multiple",matches:function(e){return V("invite",e)},action:function(o){ox.load(["io.ox/files/actions/share"]).done(function(t){if(o.models&&o.models.length)t.invite(o.models);else{var n=o.app.folder.get(),r=new i.Model(e.pool.getModel(n).toJSON());t.invite([r])}})}}),new L("io.ox/files/actions/getalink",{capabilities:"share_links",collection:"!multiple",matches:function(e){return V("link",e)},action:function(o){ox.load(["io.ox/files/actions/share"]).done(function(t){if(o.models&&o.models.length)t.link(o.models);else{var n=o.app.folder.get(),r=new i.Model(e.pool.getModel(n).toJSON());t.link([r])}})}}),new L("io.ox/files/share/revoke",{matches:function(e){return!!e.app&&(!!e.app.mysharesListView&&(!!e.app.mysharesListView.$el&&1===e.app.mysharesListView.selection.get().length))},action:_.throttle(function(o){require(["io.ox/files/share/permissions","io.ox/files/share/api"],function(n,r){var s=_.isArray(o.models)?o.models:[o.models];if(s&&s.length){var l,a,c,d,f,m=_.first(s),h=o.app.mysharesListView.$el.find(".list-item.selected").attr("data-share-type"),v=new r.Model(m.isFile()?m.pick("id","folder_id"):m.pick("id")),x={module:"infostore",folder:m.get("folder_id")||m.get("id")},g=_.map(o.models,function(e){return e.toJSON()});if(b(o.app.mysharesListView,g),void 0===h)return;v.loadExtendedPermissions().done(function(){if("public-link"===h){var o;m.isFile()?(x.item=m.get("id"),o=i.get(_.pick(m.toJSON(),"id","folder_id"),{cache:!1}).then(function(e){return e.sequence_number})):o=e.get(m.get("id"),{cache:!1}).then(function(e){return e.last_modified_utc}),o.done(function(e){t.deleteLink(x,e).done(function(){p("success",u("Revoked access.")),v.destroy.bind(v)}).fail(function(e){"ERROR"===e.categories&&"SHR-0023"===e.code?ox.trigger("refresh^"):p(e)})})}else v.reload().done(function(){l=v.getPermissions().filter(function(e){return"anonymous"===e.type||ox.user_id===e.entity}),v.setPermissions(l),m.isFolder()?e.get(m.get("id")).done(function(i){c=new e.FolderModel(i),d=c.get("permissions").filter(function(e){return!!_.where(l,{entity:e.entity}).length}),e.update(c.get("id"),{permissions:d}).done(function(){p("success",u("Revoked access."))}).fail(function(e){p(e)})}):i.get(_.pick(m.toJSON(),"id","folder_id")).done(function(e){a=new i.Model(e),d=a.get("object_permissions").filter(function(e){return!!_.where(l,{entity:e.entity}).length}),f=a.get("com.openexchange.share.extendedObjectPermissions").filter(function(e){return!!_.where(l,{entity:e.entity}).length}),i.update(e,{object_permissions:d,"com.openexchange.share.extendedObjectPermissions":f},{silent:!0}).done(function(){a.destroy.bind(a),p("success",u("Revoked access."))}).fail(function(e){p(e)})})})}).fail(function(e){p(e)})}})},600)}),new L("io.ox/files/versions/actions/makeCurrent",{collection:"one && items && modify",matches:function(e){return!h(e)&&!e.first().current_version},action:function(e){i.versions.setCurrent(e.first())}}),new L("io.ox/files/versions/actions/deletePreviousVersions",{collection:"one && items && modify",matches:function(e){return!e.latestVersion&&!h(e)},action:function(e){ox.load(["io.ox/files/actions/delete-previous-versions"]).done(function(i){i(e.first())})}}),new L("io.ox/files/versions/actions/delete",{collection:"one && items && delete",matches:function(e){return!h(e)},action:function(e){ox.load(["io.ox/files/actions/versions-delete"]).done(function(i){i(e.first())})}}),new L("io.ox/files/actions/add-folder",{matches:function(i){var o=e.pool.getModel(i.app.folder.get());return e.can("create:folder",o.toJSON())&&!e.is("trash",o.toJSON())},action:function(i){var o=i.app.folder.get(),t=e.pool.getModel(o);ox.load(["io.ox/core/folder/actions/add"]).done(function(e){e(o,{module:t.get("module")})})}}),new L("io.ox/files/premium/actions/synchronize",{capabilities:"boxcom || google || microsoftgraph",matches:function(){return a.has("client-onboarding")},action:function(){require(["io.ox/onboarding/clients/wizard"],function(e){e.run()})}}),new L("io.ox/files/actions/show-in-folder",{device:"!smartphone",collection:"one",matches:function(i){if(!i.originFavorites&&!i.originMyShares&&!i.portal)return!1;var o=i.first(),t=i.collection.has("folders")?o.id:o.folder_id;return!!e.pool.getModel(t)},action:function(e){function i(){l?l.off("listview:shown",i):a?a.off("listview:shown",i):s.off("listview:shown",i),s.off("collection:rendered",i),s.selection.set([c],!0);var e=o.listView.selection.getNode(c);s.selection.selectAll(e)}var o=e.app,t=e.models[0],n=t.attributes,r=t.isFile()?n.folder_id:n.id,s=o.listView,l=o.mysharesListView,a=o.myfavoritesListView,c=o.listView.getCompositeKey(t),d=e.alwaysChange;l&&l.$el.is(":visible")?l.on("listview:shown",i):a&&a.$el.is(":visible")?a.on("listview:shown",i):(s.on("listview:shown",i),s.on("listview:reset",i)),d&&o.folder.get()===r?i():o.folder.set(r)}}),new L("io.ox/files/actions/favorites/add",{capabilities:"!guest && !anonymous",matches:function(i){if(m(i))return!1;if(i.originFavorites)return!1;var o=f.get("favorites/infostore",[]),t=f.get("favoriteFiles/infostore",[]),n=[].concat(o,_(t).pluck("id"));return!E(i).some(function(i){return!!i.space||("localFile"===i.group||(!!e.is("trash",i)||(null===i.id||_(n).contains(i.id))))})},action:function(e){var i=M(E(e));ox.load(["io.ox/files/actions/favorites"]).done(function(e){e.add(i)})}}),new L("io.ox/files/actions/favorites/remove",{capabilities:"!guest && !anonymous",matches:function(e){var i=f.get("favorites/infostore",[]),o=f.get("favoriteFiles/infostore",[]),t=[].concat(i,_(o).pluck("id"));return E(e).some(function(e){return _(t).contains(e.id)})},action:function(e){var i=M(E(e));ox.load(["io.ox/files/actions/favorites"]).done(function(o){e.app&&e.app.myFavoriteListView&&b(e.app.myFavoriteListView,i),o.remove(i)})}}),new L("io.ox/files/favorite/back",{toggle:_.device("smartphone"),matches:function(e){return e.originFavorites},action:function(){$('[data-page-id="io.ox/files/main"]').trigger("myfavorites-folder-back")}}),s.point("io.ox/files/toolbar/new").extend({index:100,id:"upload",title:u("Upload files"),ref:"io.ox/files/actions/upload",section:"upload"},{index:200,id:"note",title:u("Add note"),ref:"io.ox/files/actions/editor-new",section:"add"},{index:300,id:"add-folder",title:u("Add new folder"),ref:"io.ox/files/actions/add-folder",section:"add"}),s.point("io.ox/files/toolbar/share").extend({index:100,id:"invite",title:u("Invite people"),caption:u("Every recipient gets an individual link. Guests can also create and change files."),section:"invite",ref:"io.ox/files/actions/invite"},{index:200,id:"getalink",title:u("Create sharing link"),caption:u("Everybody gets the same link. The link just allows to view the file or folder."),section:"link",ref:"io.ox/files/actions/getalink"});var q=[{id:"openviewer",prio:"hi",mobile:"hi",title:u("View"),ref:"io.ox/files/actions/viewer"},{id:"editor",prio:"hi",mobile:"lo",title:u("Edit"),ref:"io.ox/files/actions/editor"},{id:"download",prio:"hi",mobile:"hi",title:u("Download"),icon:"fa fa-download",ref:"io.ox/files/actions/download"},{id:"download-folder",prio:"hi",mobile:"lo",title:u("Download"),ref:"io.ox/files/actions/download-folder"},{id:"delete",prio:"hi",mobile:"hi",icon:"fa fa-trash-o",title:u("Delete"),ref:"io.ox/files/actions/delete"},{id:"favorite-add",prio:"hi",mobile:"lo",title:u("Add to favorites"),ref:"io.ox/files/actions/favorites/add"},{id:"favorite-remove",prio:"hi",mobile:"lo",title:u("Remove from favorites"),ref:"io.ox/files/actions/favorites/remove"},{id:"add-to-portal",prio:"lo",mobile:"none",title:u("Add to portal"),ref:"io.ox/files/actions/add-to-portal",section:"share"},{id:"send",prio:"lo",mobile:"hi",icon:_.device("smartphone")?"fa fa-envelope-o":"",title:u("Send by email"),ref:"io.ox/files/actions/send",section:"share"},{id:"invite",prio:"lo",mobile:"lo",title:u("Invite people"),ref:"io.ox/files/actions/invite",section:"share"},{id:"getalink",prio:"lo",mobile:"lo",title:u("Create sharing link"),ref:"io.ox/files/actions/getalink",section:"share"},{id:"rename",prio:"lo",mobile:"lo",title:u("Rename"),ref:"io.ox/files/actions/rename",section:"edit"},{id:"edit-description",prio:"lo",mobile:"lo",title:u("Edit description"),ref:"io.ox/files/actions/edit-description",section:"edit"},{id:"move",prio:"lo",mobile:"lo",title:u("Move"),ref:"io.ox/files/actions/move",section:"file-op"},{id:"copy",prio:"lo",mobile:"lo",title:u("Copy"),ref:"io.ox/files/actions/copy",section:"file-op"},{id:"lock",prio:"lo",mobile:"lo",title:u("Lock"),ref:"io.ox/files/actions/lock",section:"file-op"},{id:"unlock",prio:"lo",mobile:"lo",title:u("Unlock"),ref:"io.ox/files/actions/unlock",section:"file-op"},{id:"restore",prio:"lo",mobile:"lo",title:u("Restore"),ref:"io.ox/files/actions/restore",section:"file-op"}];s.point("io.ox/files/links/inline").extend(q.map(function(e,i){return e.index=100+100*i,e})),s.point("io.ox/files/versions/links/inline").extend({id:"view",index:100,prio:"lo",mobile:"lo",title:u("View"),ref:"io.ox/files/actions/viewer",section:"view"},{id:"editor",index:150,prio:"lo",mobile:"lo",title:u("Edit"),ref:"io.ox/files/actions/editor",section:"edit"},{id:"download",index:200,prio:"lo",mobile:"lo",title:u("Download"),ref:"io.ox/files/actions/downloadversion",section:"edit"},{id:"makeCurrent",index:250,prio:"lo",mobile:"lo",title:u("Make this the current version"),ref:"io.ox/files/versions/actions/makeCurrent",section:"edit"},{id:"delete",index:300,prio:"lo",mobile:"lo",title:u("Delete version"),ref:"io.ox/files/versions/actions/delete",section:"delete"},{id:"deletePreviousVersions",index:310,prio:"lo",mobile:"lo",title:u("Delete all previous versions"),ref:"io.ox/files/versions/actions/deletePreviousVersions",section:"delete"}),s.point("io.ox/files/dnd/actions").extend({id:"create",index:10,label:u('Drop here to upload a <b class="dndignore">new file</b>'),multiple:function(e,i){require(["io.ox/files/upload/main"],function(o){o.create.offer(e,{folder:i.folder.get()})})}}),s.point("io.ox/files/dnd/actions").extend({id:"newVersion",index:20,isEnabled:function(e){return!!e.currentFile},label:function(e){return e.currentFile.filename||e.currentFile.title?u('Drop here to upload a <b class="dndignore">new version</b> of "%1$s"',String(e.currentFile.filename||e.currentFile.title).replace(/</g,"&lt;")):u('Drop here to upload a <b class="dndignore">new version</b>')},action:function(e,i){require(["io.ox/files/upload/main"],function(o){o.update.offer(e,{folder:i.folder.get()})})}}),s.point("io.ox/files/folderview/premium-area").extend({index:100,id:"inline-premium-links",draw:function(e){this.append(e.renderActions("io.ox/files/links/premium-links",e))}}),s.point("io.ox/files/links/premium-links").extend({index:100,id:"share-files",action:"io.ox/files/premium/actions/synchronize",title:u("Share your folders")})});