define("io.ox/files/mobile-toolbar-actions",["io.ox/core/extensions","io.ox/backbone/views/actions/util","io.ox/backbone/views/actions/mobile","io.ox/backbone/views/toolbar","io.ox/files/api","gettext!io.ox/mail","io.ox/files/actions"],function(i,o,e,t,n,a){"use strict";var l=o.Action,s={create:{prio:"hi",mobile:"hi",icon:"fa fa-plus",dropdown:"io.ox/files/toolbar/new",drawDisabled:!0,caret:!1},"view-icon":{prio:"hi",mobile:"hi",label:a("Show icons"),icon:"fa fa-th",ref:"io.ox/files/actions/layout-icon",drawDisabled:!0},"view-tile":{prio:"hi",mobile:"hi",label:a("Show tiles"),icon:"fa fa-th-large",ref:"io.ox/files/actions/layout-tile",drawDisabled:!0},"view-list":{prio:"hi",mobile:"hi",label:a("Show list"),icon:"fa fa-align-justify",ref:"io.ox/files/actions/layout-list",drawDisabled:!0}},c={listView:"io.ox/files/mobile/toolbar/main",listViewMultiSelect:"io.ox/files/mobile/toolbar/main/multiselect"};i.point(c.listViewMultiSelect+"/links").extend(i.point("io.ox/files/links/inline").list().map(function(i){switch((i=_(i).pick("id","index","prio","mobile","icon","title","ref","section","sectionTitle")).id){case"openviewer":i.icon="fa fa-eye"}return i})),e.addAction(c.listView,s,["create","view-list","view-icon","view-tile"]),e.createToolbarExtensions(c),new l("io.ox/files/actions/layout-list",{action:function(i){i.app.props.set("layout","list")}}),new l("io.ox/files/actions/layout-icon",{action:function(i){i.app.props.set("layout","icon")}}),new l("io.ox/files/actions/layout-tile",{action:function(i){i.app.props.set("layout","tile")}});var r=_.debounce(function(o){if(o){var e=o,t=n.resolve(e,!1);o=_(t).invoke("toJSON");var a=i.Baton({data:o,app:this,models:t,collection:this.listView.collection,allIds:[]});this.pages.getSecondaryToolbar("main").setBaton(a)}},10);i.point("io.ox/files/mediator").extend({id:"toolbar-mobile",index:10100,setup:function(i){_.device("!smartphone")||(i.updateToolbar=r)}}),i.point("io.ox/files/mediator").extend({id:"update-toolbar-mobile",index:10300,setup:function(o){function e(){o.folder.getData().done(function(e){var t=i.Baton({data:e,app:o});o.pages.getToolbar("main").setBaton(t)})}_.device("smartphone")&&(o.on("folder:change",e),e(),o.on("selection:setup",function(){o.selection.on("select",function(i,e){o.updateToolbar(e)})}),o.listView.on("selection:change",_.debounce(function(i){i=i||o.listView.selection.get(),o.pages.toggleSecondaryToolbar("main",i.length>0),o.updateToolbar(i)},10)),o.pages.getPage("main").on("pageshow",function(){o.pages.getToolbar("main").setBaton(new i.Baton({app:o}))}))}})});