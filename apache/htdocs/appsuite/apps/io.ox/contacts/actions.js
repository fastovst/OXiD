define("io.ox/contacts/actions",["io.ox/core/extensions","io.ox/backbone/views/actions/util","io.ox/contacts/api","io.ox/portal/util","settings!io.ox/contacts","settings!io.ox/mail","gettext!io.ox/contacts","io.ox/core/pim/actions"],function(o,t,i,n,e,c,a){"use strict";function s(o,t,n){return function(c){var a=c.grid||c.app&&c.app.getGrid();ox.load(["io.ox/core/folder/actions/move"]).done(function(s){s.item({api:i,button:t,flat:!0,indent:!1,list:c.array(),module:"contacts",root:"1",settings:e,success:n,target:c.target,title:t,type:o,vgrid:a})})}}function r(o){var t=_.cid(o);return _(n.getWidgetsByType("stickycontact")).any(function(o){return _.cid(o.props)===t})}var d=t.Action;new d("io.ox/contacts/actions/delete",{index:100,collection:"some && delete",action:function(o){ox.load(["io.ox/contacts/actions/delete"]).done(function(t){t(o)})}}),new d("io.ox/contacts/actions/update",{index:100,collection:"one && modify",action:function(o){var t=o.first();!0===t.mark_as_distributionlist?ox.load(["io.ox/contacts/distrib/main"]).done(function(o){o.reuse("edit",t)||o.getApp(t).launch().done(function(){this.edit(t)})}):ox.load(["io.ox/contacts/edit/main"]).done(function(o){o.reuse("edit",t)||o.getApp(t).launch()})}}),new d("io.ox/contacts/actions/create",{folder:"create",action:function(o){ox.load(["io.ox/contacts/edit/main"]).done(function(t){t.getApp({folder_id:o.folder_id}).launch().done(function(t){t&&o.app.getGrid().selection.set(t)})})}}),new d("io.ox/contacts/actions/distrib",{device:"!smartphone",folder:"create",action:function(o){ox.load(["io.ox/contacts/distrib/main"]).done(function(t){t.getApp().launch().done(function(){this.create(o.folder_id)})})}}),new d("io.ox/contacts/actions/move",{collection:"some && read && delete",action:s("move",a("Move"),{multiple:a("Contacts have been moved"),single:a("Contact has been moved")})}),new d("io.ox/contacts/actions/copy",{collection:"some && read",action:s("copy",a("Copy"),{multiple:a("Contacts have been copied"),single:a("Contact has been copied")})}),new d("io.ox/contacts/actions/send",{capabilities:"webmail",collection:"some",every:"mark_as_distributionlist || email1 || email2 || email3",action:function(o){require(["io.ox/contacts/actions/send"],function(t){t(o.array())})}}),new d("io.ox/contacts/actions/export",{collection:"some && read",action:function(o){require(["io.ox/core/export"],function(t){t.open("contacts",{list:o.array()})})}}),new d("io.ox/contacts/actions/vcard",{capabilities:"webmail",collection:"some && read",action:function(o){return i.getList(o.array(),!1,{allColumns:!0}).then(function(o){ox.registry.call("mail-compose","open",{attachments:o.map(function(o){return{origin:"contacts",id:o.id,folderId:o.folder_id}})})})}}),new d("io.ox/contacts/actions/invite",{capabilities:"calendar",collection:"some",every:"mark_as_distributionlist || internal_userid ||Â email1 || email2 || email3",action:function(o){require(["io.ox/contacts/actions/invite"],function(t){t(o.array())})}}),new d("io.ox/contacts/actions/add-to-portal",{capabilities:"portal",collection:"one",every:"id && folder_id && mark_as_distributionlist",matches:function(o){var t=o.first();return t.mark_as_distributionlist&&!r(t)},action:function(o){require(["io.ox/contacts/actions/addToPortal"],function(t){t(o)})}}),new d("io.ox/contacts/actions/add-to-contactlist",{collection:"one",matches:function(o){var t=o.first();return t.folder_id===c.get("contactCollectFolder")||!t.folder_id&&!t.id},action:function(t){var i=_(t.first()).omit("folder_id","id");t=o.Baton({data:i}),require(["io.ox/contacts/actions/addToContactlist"],function(o){o(t)})}}),new d("io.ox/contacts/actions/print",{device:"!smartphone",collection:"some && read",matches:function(o){return"list"===e.get("features/printList")||o.array().some(function(o){return!o.mark_as_distributionlist})},action:function(o){require(["io.ox/contacts/actions/print"],function(t){t.multiple(o.array())})}}),new d("io.ox/contacts/premium/actions/synchronize",{capabilities:"carddav client-onboarding",action:function(){require(["io.ox/onboarding/clients/wizard"],function(o){o.run()})}}),o.point("io.ox/contacts/toolbar/new").extend({id:"create",index:100,title:a("New contact"),ref:"io.ox/contacts/actions/create"},{id:"create-dist",index:200,title:a("New distribution list"),ref:"io.ox/contacts/actions/distrib"});var l=100;o.point("io.ox/contacts/links/inline").extend({id:"add-to-contactlist",prio:"hi",index:l+=100,title:a("Add to address book"),ref:"io.ox/contacts/actions/add-to-contactlist"},{id:"edit",index:l+=100,prio:"hi",mobile:"hi",title:a("Edit"),ref:"io.ox/contacts/actions/update"},{id:"send",index:l+=100,prio:"hi",mobile:"hi",title:a("Send email"),ref:"io.ox/contacts/actions/send"},{id:"invite",index:l+=100,prio:"hi",mobile:"hi",title:a("Invite"),tooltip:a("Invite to appointment"),ref:"io.ox/contacts/actions/invite"},{id:"delete",index:l+=100,prio:"hi",mobile:"hi",title:a("Delete"),ref:"io.ox/contacts/actions/delete"},{id:"vcard",index:l+=100,prio:"lo",mobile:"lo",title:a("Send as vCard"),ref:"io.ox/contacts/actions/vcard"},{id:"move",index:l+=100,mobile:"lo",title:a("Move"),ref:"io.ox/contacts/actions/move",section:"file-op"},{id:"copy",index:l+=100,mobile:"lo",title:a("Copy"),ref:"io.ox/contacts/actions/copy",section:"file-op"},{id:"print",index:l+=100,title:a("Print"),ref:"io.ox/contacts/actions/print",section:"export"},{id:"export",index:l+=100,prio:"lo",mobile:"lo",title:a("Export"),ref:"io.ox/contacts/actions/export",section:"export"},{id:"add-to-portal",index:l+=100,mobile:"lo",title:a("Add to portal"),ref:"io.ox/contacts/actions/add-to-portal",section:"export"}),o.point("io.ox/contacts/folderview/premium-area").extend({index:100,id:"inline-premium-links",draw:function(o){this.append(o.renderActions("io.ox/contacts/links/premium-links",o))}}),o.point("io.ox/contacts/links/premium-links").extend({index:100,id:"synchronize-contacts",action:"io.ox/contacts/premium/actions/synchronize",title:a("Share your contacts")})});