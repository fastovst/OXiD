define("io.ox/mail/sender",["io.ox/mail/util","io.ox/core/api/account","io.ox/core/api/user","io.ox/contacts/api","io.ox/core/capabilities","settings!io.ox/mail"],function(e,t,r,n,s,i){"use strict";function o(e,t){return e=e.value,t=t.value,e<t?-1:1}function u(t){return{text:e.formatSender(t[0],t[1],!1),value:e.formatSender(t[0],t[1])}}var d={getUser:function(){return r.get({id:ox.user_id})},getDefaultSendAddress:function(){return $.trim(i.get("defaultSendAddress",""))},getAccounts:function(e){return t.getAllSenderAddresses(e)},getDisplayName:function(){return t.getDefaultDisplayName()},getPrimaryAddress:function(){return t.getPrimaryAddress()},getAddresses:function(e){return $.when(d.getAccounts(e),d.getPrimaryAddress())},getAddressesOptions:function(e){var t=i.get("defaultSendAddress","").trim();return d.getAddresses(e).then(function(e,r){var n=t||r[1],s=[].concat(e);return s=_(s).map(function(e){return{value:u(e).value,option:e}}),{sortedAddresses:s.sort(o),defaultAddress:n}})}};return d});