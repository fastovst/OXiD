define("io.ox/mail/actions/attachmentQuota",["io.ox/core/tk/dialogs","io.ox/core/notifications","io.ox/core/strings","settings!io.ox/core","gettext!io.ox/mail"],function(e,i,o,t,a){"use strict";return{checkQuota:function(e,r){var s,n,f=e,l=t.get("properties"),u=r||0,c=require("io.ox/core/capabilities").has("publish_mail_attachments"),h={};if(f.length)return s=c?-1:l.attachmentQuotaPerFile,n=c?-1:l.attachmentQuota,_.find(f,function(e){var i=e.filename||e.name||e.subject,t=e.file_size||e.size;if(t){if(u+=t,n>0&&u>n)return h.error=a('The file "%1$s" cannot be uploaded because it exceeds the total attachment size limit of %2$s',i,o.fileSize(n)),h.reason="filesize",!0;if(s>0&&t>s)return h.error=a('The file "%1$s" cannot be uploaded because it exceeds the maximum file size of %2$s',i,o.fileSize(s)),h.reason="filesize",!0;if(c){if(l.infostoreMaxUploadSize>0&&t>l.infostoreMaxUploadSize)return h.error=a('The file "%1$s" cannot be uploaded because it exceeds the attachment publication maximum file size of %2$s',i,o.fileSize(l.infostoreMaxUploadSize)),h.reason="filesizeAutoPublish",!0;if(l.infostoreQuota>0&&u>l.infostoreQuota-l.infostoreUsage)return h.error=a('The file "%1$s" cannot be uploaded because it exceeds the infostore quota limit of %2$s',i,o.fileSize(l.infostoreQuota)),h.reason="quotaAutoPublish",!0}}}),!h.error||(i.yell("error",h.error),!1)}}});