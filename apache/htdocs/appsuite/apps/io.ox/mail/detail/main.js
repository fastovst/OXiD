define("io.ox/mail/detail/main",["io.ox/mail/threadview","io.ox/mail/api","io.ox/mail/util","io.ox/core/notifications"],function(e,t,i,a){"use strict";var o="io.ox/mail/detail";return ox.ui.App.mediator(o,{"thread-view":function(t){t.threadView=new e.Desktop({disableDrag:!0,standalone:!0}),t.getWindow().nodes.main.addClass("detail-view-app").append(t.threadView.render().$el)},"show-mail":function(e){e.showMail=function(t){if(e.threadView.show(t),e.threadView.model){var a=e.threadView.model.get("subject");e.setTitle(i.getSubject(a)),e.threadView.listenTo(e.threadView.model,"remove",function(){e.quit()})}}},metrics:function(e){require(["io.ox/metrics/main"],function(t){function i(e,i){var a=!!(i=$(i)).attr("data-name");t.trackEvent({app:"mail",target:e,type:"click",action:a?i.attr("data-name"):i.attr("data-action"),detail:a?i.attr("data-value"):""})}t.isEnabled()&&e.getWindow().nodes.body.on("track",function(e,t){i("detail-standalone/toolbar",t)})})}}),{getApp:function(){function e(e){t.get(_.cid(e)).then(function(){i.showMail(e)},a.yell)}var i=ox.ui.createApp({closable:!0,floating:!_.device("smartphone"),name:o,title:""});return i.on("quit",function(){i.threadView.remove(),i.threadView=null}),i.setLauncher(function(t){var a=ox.ui.createWindow({chromeless:!0,name:o,toolbar:!1,closable:!0,floating:!_.device("smartphone")});i.setWindow(a),i.mediate(),a.show();var n,d=t.cid;if(void 0!==d)return n=_.cid(String(d).replace(/^thread\./,"")),i.setState({folder:n.folder_id,id:n.id}),e(d);n=i.getState(),d=_.cid(n),n.folder&&n.id&&e(d)})}}});