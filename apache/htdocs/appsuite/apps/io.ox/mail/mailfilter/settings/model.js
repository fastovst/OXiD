define("io.ox/mail/mailfilter/settings/model",["io.ox/backbone/modelFactory","io.ox/backbone/validation","io.ox/core/api/mailfilter","io.ox/settings/util","gettext!io.ox/mail","io.ox/mail/mailfilter/settings/util"],function(t,e,i,a,o,n){"use strict";return{api:i,protectedMethods:{buildFactory:function(i,r){var l=new t({api:r,ref:i,model:{idAttribute:"id",initialize:function(){this.on("change",this.onChangeAttribute),Object.getPrototypeOf(Object.getPrototypeOf(this)).initialize.apply(this,arguments)},onChangeAttribute:function(){var t=this;(this.changed.actioncmds||this.changed.test)&&$.when(n.getDefaultRulename(this.previousAttributes()),n.getDefaultRulename(this.attributes)).done(function(e,i){t.get("rulename")!==e&&t.get("rulename")!==o("New rule")||t.set("rulename",i)})}},update:function(t){return a.yellOnReject(r.update(t.attributes))},create:function(t){return a.yellOnReject(r.create(t.attributes))}});return e.validationFor(i,{rulename:{format:"string"},test:{format:"object"},actioncmds:{format:"array"},flags:{format:"array"},active:{format:"boolean"}}),l},provideEmptyModel:function(){return{rulename:o("New rule"),test:{id:"true"},actioncmds:[],flags:[],active:!0}}}}});