define("io.ox/core/main/refresh",["io.ox/core/session","io.ox/core/http","io.ox/core/extensions","io.ox/core/capabilities","settings!io.ox/core"],function(e,o,r,n,i){var t;return function(){var e=_.now();r.point("io.ox/core/refresh").extend({action:_.throttle(function(){if(ox.online&&""!==ox.session)try{ox.trigger("refresh^")}catch(e){console.error("io.ox/core/refresh:default",e.message,e)}},1e4),reset:function(){e=_.now()+parseInt(i.get("refreshInterval",3e5),10)}}),t=function(){r.point("io.ox/core/refresh").invoke("action"),r.point("io.ox/core/refresh").invoke("reset")},i.on("change:refreshInterval",function(){r.point("io.ox/core/refresh").invoke("reset")}),r.point("io.ox/core/refresh").invoke("reset"),setInterval(function(){_.now()>e&&(r.point("io.ox/core/refresh").invoke("action"),r.point("io.ox/core/refresh").invoke("reset"))},1e4)}(),t});