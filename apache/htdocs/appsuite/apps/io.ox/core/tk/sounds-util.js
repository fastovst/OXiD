define("io.ox/core/tk/sounds-util",["io.ox/core/extensions","gettext!plugins/notifications","settings!io.ox/mail"],function(e,n,o){"use strict";function i(e){var n=$.Deferred();return e=_(u).find({value:e})?e:"bell",e=new Audio(d+e+l),e.volume=a,e.addEventListener("canplaythrough",function(){n.resolve(e)}),n}var t,a=.3,d=ox.base+"/apps/themes/default/sounds/",l=_.device("!windows && !macos && !ios && !android")?".ogg":".mp3",u=[{label:n("Bell"),value:"bell"},{label:n("Marimba"),value:"marimba"},{label:n("Wood"),value:"wood"},{label:n("Chimes"),value:"chimes"}],s=_.throttle(function(){_.device("smartphone")||t&&t.play()},2e3);return o.on("change:notificationSoundName",function(){_.device("smartphone")||i(o.get("notificationSoundName")).done(function(e){e&&(e.play(),t=e)})}),_.device("!smartphone")&&i(o.get("notificationSoundName")).done(function(e){t=e}),e.point("io.ox/mail/settings/detail/view").extend({index:250,id:"sounds_extend",render:function(){this.getSoundOptions=function(){return u}}}),{playSound:s}});