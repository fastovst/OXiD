define("io.ox/core/viewer/views/types/typesutil",["io.ox/core/capabilities","io.ox/core/extensions"],function(e,i){"use strict";var t={image:"imageview",doc:"documentview",xls:"spreadsheetview",ppt:"documentview",pdf:"documentview",audio:"audioview",vcf:"contactview",video:"videoview",txt:"textview"};return{getTypeString:function(i){if(!i)return"defaultview";var n=t[i.isEncrypted()?i.getGuardType():i.getFileType()]||"defaultview";return"spreadsheetview"!==n||e.has("spreadsheet")&&this.isNativeDocumentType(i)&&!i.isComposeAttachment()||(n="documentview"),"documentview"!==n||e.has("document_preview")||(n="defaultview"),i.isEmptyFile()&&(n="descriptionview"),i.isMailAttachment()&&"message/rfc822"===i.get("file_mimetype")&&(n="mailview"),"contactview"===n&&(i.get("file_mimetype")||"").indexOf("text/vcard")>=0&&(n="defaultview"),n},canView:function(e){return"defaultview"!==this.getTypeString(e)},isDocumentType:function(e){return"documentview"===this.getTypeString(e)},isSpreadsheetType:function(e){return"spreadsheetview"===this.getTypeString(e)},isOfficeAvailable:function(){return e.has("text")||e.has("presentation")||e.has("spreadsheet")},isNativeDocumentType:function(e){if(!this.isOfficeAvailable())return!1;var t=new i.Baton({data:e});return function(e){return!(!e||!_.isArray(e._wrapped))&&e._wrapped[0]}(i.point("io.ox/office/extensionregistry").invoke("isNative",null,t))}}});