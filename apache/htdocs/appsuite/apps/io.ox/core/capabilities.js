define("io.ox/core/capabilities",function(){"use strict";var e={},t={},i={},a={get:function(t){return 0===arguments.length?e:(t=String(t).toLowerCase(),e[t])},isDisabled:function(e){return e in i},has:function(){var t=_(arguments).flatten().join(" && ").replace(/([^&|]) ([^&|])/gi,"$1 && $2").toLowerCase(),i=t.replace(/[a-z0-9_:\-./]+/gi,function(t){return!a.isDisabled(t)&&t in e});try{return new Function("return !!("+i+")")()}catch(e){return _.device("!karma")&&console.error("capabilities.has()",t,e),!1}},reset:function(){e=_.extend({},t),_(ox.serverConfig.capabilities).each(function(t){e[t.id]=t})}};a.reset();var n=[],r=_.getCookie("cap");ox.cap&&(n=ox.cap.split(/\s*[, ]\s*/)),r&&(n=n.concat(r.split(/\s*[, ]\s*/)));var s=_.url.hash("ref")?_.deserialize(_.url.hash("ref")):_.url.hash();s.cap&&(n=n.concat(s.cap.split(/\s*[, ]\s*/))),_(n).each(function(a){"-"===a[0]?(a=a.substr(1),i[a]=!0):(e[a]=t[a]={attributes:{},backendSupport:!1,id:a},delete i[a],console.info("Enabled feature",a))}),s.disableFeature&&_(s.disableFeature.split(/\s*[, ]\s*/)).each(function(e){i[e]=!0});var c=_(i).keys().sort();return c.length&&console.info("Disabled capabilities: "+c.join(", ")),a.getFlat=function(){var e=_.pluck(a.get(),"id").sort(),t={enabled:[],disabled:[],mismatch:[]};return _.each(e,function(e){a.has(e)?t.enabled.push(e):t.disabled.push(e)}),t},a});