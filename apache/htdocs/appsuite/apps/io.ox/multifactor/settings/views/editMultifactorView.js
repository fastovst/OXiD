define("io.ox/multifactor/settings/views/editMultifactorView",["io.ox/backbone/views","io.ox/core/extensions","io.ox/backbone/mini-views","io.ox/backbone/views/modal","io.ox/core/yell","io.ox/multifactor/api","io.ox/multifactor/auth","gettext!io.ox/core/boot"],function(e,t,o,i,n,r,a,d){"use strict";function c(e){return new i({async:!0,point:s,title:d("Edit Multifactor Device"),width:640,enter:"ok",model:new Backbone.Model({device:e,id:$(e).attr("data-deviceId"),name:$(e).attr("data-deviceName"),provider:$(e).attr("data-provider")})}).build(function(){}).addCancelButton().addButton({label:d("Save"),action:"ok"}).on("ok",function(){var e=this;l(this.model,$("#newName").val()).done(function(){e.close(),u.resolve()}).fail(function(t){e.idle(),t&&t.length>1&&n("error",t),u.reject()})}).open()}function l(e,t){if(t){var o=$.Deferred();return r.editDevice(e.get("provider"),e.get("id"),t).then(o.resolve,function(e){n("error",d("Unable to edit name.")+(e&&e.error?" "+e.error:"")),o.reject()}),o}o.reject()}var u,s="multifactor/settings/editMultifactor",f=0;return t.point(s).extend({index:f+=100,id:"header",render:function(e){var t=e.model.get("name"),o=$('<label for="newName">').text(t?d("This will edit the name for device (%s)",t):d("This will assign a name to the device")).append("<br>");this.$body.append(o)}},{index:f+=100,id:"newName",render:function(e){var t=$('<input type="text" class="form-control mfInput" id="newName">'),o=$('<div class="multifactorRename">').append(t);t.val(e.model.get("name")),this.$body.append(o),window.setTimeout(function(){t.focus()},100)}}),{open:function(e){return c(e),u=new $.Deferred},doEdit:l}});