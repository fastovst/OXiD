define("io.ox/multifactor/views/totpProvider",["io.ox/backbone/views","io.ox/core/extensions","io.ox/backbone/mini-views","io.ox/backbone/views/modal","gettext!io.ox/core/boot","io.ox/multifactor/views/constants","io.ox/backbone/mini-views/helplink"],function(e,t,o,i,n,r,a){"use strict";function c(e,t){return new i({async:!0,point:s,title:t.reAuth?r.ReAuthenticationTitle:r.AuthenticationTitle,enter:"OK",className:r.AuthDialogClass,model:new Backbone.Model({provider:t.providerName,deviceId:t.device.id,challenge:e,error:t.error})}).build(function(){}).addCancelButton().addButton({label:r.OKButton,action:"OK"}).addAlternativeButton({label:r.LostButton,action:"lost",className:t.device.backup?"hidden":"btn-default"}).on("OK",function(){var e=$("#authentication").val().replace(/\s/g,"");if(e&&""!==e){var o={response:e,id:t.device.id,provider:t.providerName};u.resolve(o)}else u.reject();l.close()}).on("cancel",function(){u.reject()}).on("open",function(){_.defer(function(){$("#authentication").focus()})}).on("lost",function(){l.close(),require(["io.ox/multifactor/lost"],function(e){e(t)})}).open()}function d(e){$(e.target).toggleClass("mfInputError",e.target.value.match(/[0-9\s]*/)[0]!==e.target.value)}var l,u,s="multifactor/views/totpProvider",p=0;return t.point(s).extend({index:p+=100,id:"help",render:function(){var e=new a({base:"help",iconClass:"mfHelp fa-question-circle fa",href:"ox.appsuite.user.sect.security.multifactor.authenticator.html ",tabindex:"-1",simple:!ox.ui.createApp,metrics:void 0!==ox.ui.createApp}).render().$el;this.$header.append(e)}},{index:p+=100,id:"help",render:function(){var e=$('<p style="multifactor-help">').append(n("You secured your account with 2-Step Verification. Please enter the verification code from the Authenticator App.")).append("<br>");this.$body.append(e)}},{index:p+=100,id:"header",render:function(){var e=$('<label for="authentication">').append("Authentication Code:").append("<br>");this.$body.append(e)}},{index:p+=100,id:"selection",render:function(){var e=$('<input type="text" class="form-control mfInput" id="authentication">').keyup(d),t=$('<div class="multifactorAuthDiv">').append(e);this.$body.append(t)}},{index:p+=100,id:"error",render:function(e){var t=e.model.get("error");if(t&&t.text){var o=$('<label class="multifactorError">').append(t.text);this.$body.append(o)}}}),{open:function(e,t){return l=c(e,t),u=t.def,l}}});