define("io.ox/find/manager/value-model",["gettext!io.ox/core"],function(t){"use strict";return Backbone.Model.extend({type:"valueBase",initialize:function(t){var e,i=t.data,n=t.facet;_.each(i.options,function(t){"folder"!==n.get("id")&&"account"!==n.get("id")||t.active&&(e=t.id)}),this.set({cid:i.id,id:i.id,style:i.style,type:"value",options:i.options||[],option:e,active:!!e,facet:n,name:i.name||(i.item||{}).name,detail:i.detail||(i.item||{}).detail,data:_.copy(i,!0)})},activate:function(t){if(_.isObject(t)){var e=this.getOption("dynamic"),i=!_.findWhere(this.get("options"),{id:t.id});e.hidden=!i,i&&(e.value=t.value,e.item.name=t.name,"dynamic"===(t="dynamic")&&this.trigger("change:option",this)),t=i?"dynamic":t.id}this.set({active:!0,option:t})},deactivate:function(){this.set({active:!1,option:void 0})},isActive:function(){return!(!this.getOption().id||"disabled"===this.getOption().id)&&!!this.get("active")},isMandatory:function(){return this.get("facet").is("mandatory")},getTypeLabel:function(){var t=this.get("facet"),e=t.getType();if("simple"!==e)return"exclusive"===e||"custom"===e?t.getName():this.getOption().name},getTokenType:function(){return this.isPerson()?this.getTypeLabel():""},getTokenValue:function(){return this.isPerson()?this.getNameDetail()||this.getDisplayName():this.getDisplayName()},getOption:function(t){var e=t||this.get("option"),i=this.get("options");return i.length?e?_.findWhere(i,{id:e})||{}:_.findWhere(i,{hidden:!1})||i[0]:this.get("data")},getOriginalId:function(){return this.get("id")},getImageUrl:function(){var t=this.get("data");if(t.item)return t.item.image_url},getFilter:function(){return this.getOption().filter},getName:function(){return"folder"===this.get("facet").get("id")?(this.getOption().item||this.getOption()).name:this.get("name")||t("All")},isPerson:function(){return this.get("facet").hasPersons()},getDisplayName:function(){var t=this.getName(),e=this.get("detail");return!e||this.isPerson()?t:t+" "+e},getNameDetail:function(){return this.get("detail")},getRequest:function(){var t={simple:function(){return{facet:this.get("facet").get("data").id,value:this.get("facet").get("cid"),filter:this.getFilter()}},default:function(){return{facet:this.get("facet").get("data").id,value:this.get("data").id,filter:this.getFilter()}},exclusive:function(){return{facet:this.get("facet").get("data").id,value:this.getOption().id,filter:this.getFilter()}},custom:function(){return{facet:this.get("facet").get("data").id.replace(".custom",""),value:this.getOption().value,filter:this.getFilter()}}};return function(){if(this.isActive()||this.isMandatory()){var e=this.get("facet").getType();return t[e].call(this)}}}()})});