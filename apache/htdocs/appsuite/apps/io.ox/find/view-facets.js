define("io.ox/find/view-facets",["io.ox/find/extensions-facets","io.ox/core/folder/api","io.ox/core/extensions","io.ox/core/api/account","gettext!io.ox/core"],function(e,t,i,n,o){"use strict";var r="io.ox/find/facets";return i.point(r+"/toolbar").extend({index:100,draw:e.toolbar}),i.point(r+"/list").extend({index:100,draw:e.list}),i.point(r+"/dropdown/default").extend({index:100,draw:e.dropdownDefault}),i.point(r+"/dropdown/default/item").extend({index:100,draw:e.item}),i.point(r+"/dropdown/folder").extend({index:100,draw:e.dropdownFolder}),i.point(r+"/dropdown/account").extend({index:100,draw:$.noop}),i.point(r+"/help").extend({index:100,draw:e.help}),Backbone.View.extend({attributes:{"aria-label":o("Search facets"),role:"navigation"},initialize:function(e){_.extend(this,e),this.setElement(this.parent.$el.find(".search-box-filter")),this.register()},register:function(){this.listenTo(this.app.model.manager,"active",$.proxy(this.redraw,this)),this.listenTo(this.app,"find:config-updated",$.proxy(this.render,this))},redraw:function(){this.render()},render:function(){return this.reset(),i.point("io.ox/find/facets/toolbar").invoke("draw",this.$el,this.baton),this.$el.find("ul.classic-toolbar").outerHeight(this.$el.parent().outerHeight()),this.$el.find("ul.classic-toolbar > li > a:not(:first)").attr("tabindex",-1),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},reset:function(){this.$el.empty()},focus:function(){this.$el.find(".facet > a").focus()},is:function(e,i,n){var o;return!!(o={readable:_.partial(t.can,"read"),virtual:function(e){return t.isVirtual(e.id)},account:function(e,t){return e.account=t.account}}[e])&&o.call(this,i,n)},openFolderDialog:function(){function e(e){if("mail"===c)return!n.isPrimary(e.id)&&(n.isPrimary(l)&&!n.isPrimary(e.id));if("infostore"===c){var t=i.model.manager.get("account");if(!t)return;return e.account_id!==t.getValue().getOption().value}return!1}var i=this,o=i.is,r=i.model.manager,a=r.get("folder"),d=a.getValue().getOption().value,s=i.baton.app.getModuleParam(),l=d||t.getDefaultFolder(c),c="files"===s?"infostore":s;require(["io.ox/core/folder/picker"],function(i){i({async:!0,folder:l,module:c,root:"files"===s?"9":"1",flat:t.isFlat(c),done:function(e,i){t.get(e).always(function(t){var n=(t||{}).title||e;r.activate(a.id,"custom",{value:e,id:e,name:n}),i.close()})},disable:function(i){return!o("readable",i)||t.is("virtual",i)||e(i)}})})}})});