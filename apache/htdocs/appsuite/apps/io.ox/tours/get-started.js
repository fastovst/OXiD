define("io.ox/tours/get-started",["io.ox/core/extensions","io.ox/core/capabilities","io.ox/core/tk/wizard","gettext!io.ox/core"],function(t,e,i,r){"use strict";var n=Backbone.View.extend({tagName:"a",events:{click:"onClick",start:"onStart"},onClick:function(t){t.preventDefault();var e=$(t.target).closest("li"),r=e.attr("data-path"),n=r&&r.split(",");require(n,function(){var t=ox.ui.App.getCurrentApp();this.$el.trigger("start",t),i.registry.run(e.attr("data-id"))}.bind(this))},onStart:function(t,e){require(["io.ox/metrics/main"],function(t){t.trackPage({id:"io.ox/guidedtour"});var i=e.get("trackingId")||e.get("name")||e.get("id");t.trackEvent({app:"core",target:"toolbar",type:"click",action:"guided-tour",detail:i.substr(i.lastIndexOf("/")+1)})})},hide:function(){if(this.$el.parent().length>0)return this.$el.parent().toggle(!1)},show:function(){if(this.$el.parent().length>0)return this.$el.parent().toggle(!0)},onAppChange:function(){if(e.has("guest"))return this.hide();var t=ox.ui.App.getCurrentApp();if(null===t)return this.hide();var i=t&&_.isFunction(t.getTour),r=i&&t.getTour();if(i&&!_.isEmpty(r))return console.warn("guided tours: getTour is deprecated. Please use a manifest entry instead."),this.show().attr({"data-id":r.id,"data-path":r.path});var n="default/"+t.getName(),a=ox.manifests.pluginsFor(n);if(a.length)return this.show().attr({"data-id":n,"data-path":a});this.hide()},initialize:function(){this.listenTo(ox,"app:ready app:resume app:stop",this.onAppChange)},render:function(){return this.$el.attr({href:"#",role:"menuitem","data-action":"guided-tour"}).text(r("Guided tour for this app")),this}});_.device("smartphone")||t.point("io.ox/core/appcontrol/right/dropdown").extend({id:"get-started",index:250,extend:function(){if(!e.has("guest")){var t=new n;this.append(t.render().$el),t.hide()}}})});