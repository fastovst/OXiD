define("io.ox/keychain/secretRecoveryDialog",["io.ox/keychain/api","io.ox/backbone/views/modal","io.ox/core/notifications","gettext!io.ox/keychain"],function(e,o,n,t){"use strict";return{show:function(){new o({title:t("Recover passwords"),description:t("Please provide the old password so the account passwords can be recovered."),easyOut:!1,async:!0,width:500,enter:"migrate"}).build(function(){var e=_.uniqueId("form-control-label-");this.$body.append($("<label>").attr("for",e).text(t("Your old password")),$('<input type="password" name"recovery-password" class="form-control">').attr("id",e))}).addCancelButton().addButton({label:t("Ignore"),action:"ignore",className:"btn-default"}).addButton({label:t("Recover"),action:"migrate"}).on("cancel",function(){this.$body.find("input").val("")}).on("ignore",function(){var o=this.busy();return e.cleanUp().done(function(){o.close()}).fail(function(e){n.yell({headline:t("Error"),type:"error",message:e.error}),o.idle()})}).on("migrate",function(){var o=this.busy();return e.migrateFromOldSecret(this.$body.find("input").val()).done(function(){o.$body.find("input").val(""),o.close(),require(["io.ox/core/folder/api"],function(e){e.list("1",{cache:!1}).done(function(){e.virtual.refresh()})})}).fail(function(e){n.yell({headline:t("Failed to recover accounts"),type:"error",message:e.error}),o.idle(),o.$body.find("input").focus().select()})}).open()}}});