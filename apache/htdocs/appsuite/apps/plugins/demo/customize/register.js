define("plugins/demo/customize/register",["io.ox/core/notifications","io.ox/core/extPatterns/stage","settings!plugins/demo/customize"],function(o,e,t){"use strict";function a(o,e,t,a){return a?"linear-gradient("+o+"deg, "+e+", "+t+", "+a+")":"linear-gradient("+o+"deg, "+e+", "+t+")"}function l(o){var e=o.get("topbarGradient"),t=o.get("topbarColor1")||"#000",l=o.get("topbarColor2")||"#000";switch(e){case 1:return a(180,t,l);case 2:return a(45,t,l);case 3:return a(70,t,l,t);default:return"none"}}function i(){var o=39+8*(p.get("topbarSize")||0);$("#io-ox-appcontrol").css("height",o),$("#io-ox-screens").css("top",o+$("#io-ox-appcontrol").offset().top),r()}function r(){if(""!==f)$("#io-ox-top-logo").find("img").attr("src",f),p.set("showLogo",!0);else{var o=$("#io-ox-top-logo").find("img");g?o.attr("src",g):g=o.attr("src"),$('#customize-dialog input[type="file"]').val("")}$("#io-ox-top-logo > img").css("maxHeight",$("#io-ox-appcontrol").height())}if(!_.device("smartphone")){$("body").append('<div class="modal" id="customize-dialog">  <div class="modal-dialog modal-sm" style="margin-top: 0">    <div class="modal-content">      <div class="modal-header">        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>        <h5 class="modal-title">Branding Wizard</h5>      </div>      <div class="modal-body container-fluid">        <div class="row form-group">          <div class="col-xs-6"><label>Top-bar color 1</label><br><input type="color" data-name="topbarColor1"></div>          <div class="col-xs-6 text-right"><label>Top-bar color 2</label><br><input type="color" data-name="topbarColor2"></div>        </div>        <div class="row form-group">          <div class="col-xs-12"><label>Gradient type</label><br><input type="range" min="0" max="3" data-name="topbarGradient"></div>        </div>        <div class="row form-group">          <div class="col-xs-12"><label>Top-bar size</label><br><input type="range" min="0" max="10" data-name="topbarSize"></div>        </div>        <div class="row form-group">          <div class="col-xs-12"><label>Product name</label><br><input type="text" class="form-control" data-name="productName"></div>        </div>        <div class="row form-group">          <div class="col-xs-6"><label>Selection</label><br><input type="color" data-name="selectionColor"></div>          <div class="col-xs-6 text-right"><label>Links</label><br><input type="color" data-name="linkColor"></div>        </div>        <div class="row form-group">          <div class="col-xs-6"><label>Tree color</label><br><input type="color" data-name="treeFgColor"></div>          <div class="col-xs-6 text-right"><label>Tree background</label><br><input type="color" data-name="treeBgColor"></div>        </div>        <div class="row form-group">          <div class="col-xs-6"><label>Office bar</label><br><input type="color" data-name="officebarColor"></div>        </div>        <div class="row form-group">          <div class="col-xs-12"><label><input type="checkbox" checked="checked" data-name="showLogo"> Show logo</label></div>        </div>        <div class="row form-group">          <div class="col-xs-12"><div class="btn-group"><span class="btn btn-default btn-file">Upload logo<input type="file" class="file-input"></span><button type="button" class="btn btn-default clear-logo">&times;</button></div></div>        </div>        <div class="row form-group">          <div class="col-xs-6 text-left"><a href="#" class="apply-preset">Browse presets</a></div>          <div class="col-xs-6 text-right">            <a href="#" class="reset-model">Reset</a>          </div>        </div>      </div>    </div>  </div></div><style id="customize-css"></style><style id="customize-css-logo"></style>'),$("#customize-dialog").modal({backdrop:!1,keyboard:!0,show:!1}),$(document).on("click","#io-ox-appcontrol",function(o){o.altKey&&$("#customize-dialog").modal("toggle")});var n=$("#customize-dialog input[data-name]"),s={topbarSize:3,topbarGradient:0,url:"",productName:"**OX** App Suite",showLogo:!1},c=[{topbarColor1:"#3774A8",selectionColor:"#428BCA",linkColor:"#428BCA"},{topbarColor1:"#3774A8",selectionColor:"#428BCA",linkColor:"#428BCA",topbarSize:4,headerColor:"#ffffff",headerBackground:"#275276"},{topbarColor1:"#992019",selectionColor:"#535353",linkColor:"#6e6e6e",topbarSize:4,headerColor:"#ffffff",headerBackground:"#6b1711"},{topbarColor1:"#49a8c6",selectionColor:"#50607f",linkColor:"#ce5200",topbarSize:4,headerColor:"#ffffff",headerBackground:"#50607f"},{topbarColor1:"#18a0ae",selectionColor:"#1baebd",linkColor:"#e84f1b",topbarSize:4,headerColor:"#ffffff",headerBackground:"#0f6b75"},{topbarColor1:"#88356f",selectionColor:"#772475",linkColor:"#785194",topbarSize:4,headerColor:"#555555"},{topbarColor1:"#474243",selectionColor:"#656465",linkColor:"#377fb5"},{topbarColor1:"#424242",selectionColor:"#39A9E1",linkColor:"#0088cc"},{topbarColor1:"#5e595d",selectionColor:"#d2450a",linkColor:"#b84700"},{topbarColor1:"#5e595d",selectionColor:"#d2450a",linkColor:"#b84700",topbarSize:4,headerColor:"#d24518"},{topbarColor1:"#736f71",selectionColor:"#707274",linkColor:"#cc2c20",topbarSize:4,headerColor:"#555555"},{topbarColor1:"#625e61",selectionColor:"#585453",linkColor:"#6388ba",topbarSize:6,headerColor:"#ffe600",headerBackground:"#454244"}],d=0,p=new Backbone.Model,u=_.debounce(function(){var o=39+8*(p.get("topbarSize")||0),e=8+4*(p.get("topbarSize")||0);$("#customize-css").text("#customize-dialog { right: 10px; left: auto; top: 45px; }\n#io-ox-appcontrol {\n  color: white; background-color: "+p.get("topbarColor1")+";\n  background-image: "+l(p)+(p.has("topbarColor1")||"none"!==l(p)?"!important":"")+";\n}\n#io-ox-appcontrol:before { display: none; }\n#io-ox-appcontrol #io-ox-launcher > button { height: "+o+"px}\n#io-ox-appcontrol #io-ox-quicklaunch > button { height: "+o+"px}\n#io-ox-appcontrol #io-ox-quicklaunch .indicator { top: "+e+"px}\n#io-ox-appcontrol .banner-logo {\n  width: 60px; height: 100%;\n  background-position: left center; background-origin: content-box; background-repeat: no-repeat;\n}\n#io-ox-appcontrol > div { display: flex; align-items: center; }\n#io-ox-top-productname { display: inline-block; font-size: 24px; line-height: 32px; font-weight: 300; white-space: nowrap; margin: 0 16px; line-height: "+o+"px; }\n#io-ox-banner .banner-logo.left { background-position: left; left: 0; }\n.hide-small-logo #io-ox-top-logo { display: none; }\n#io-ox-top-logo { font-size: 24px; line-height: "+o+"px; }\n.list-view.visible-selection.has-focus .list-item.selected,\n.list-view.visible-selection.has-focus .list-item.selected:focus,\n.list-view.visible-selection.has-focus .list-item.selected:hover,\n.list-view.visible-selection.has-focus .list-item.selected:focus:hover,\n.folder-tree.visible-selection .selectable:focus > .folder-node,\n.vgrid .vgrid-scrollpane > div:focus .vgrid-cell.selected {\n  background-color: "+p.get("selectionColor")+";\n}\na, a:hover, a:active, a:focus,\n.mail-detail .content a, .mail-detail .content a:hover,\n.mail-item div.subject i.icon-unread, .mail-item.unread .unread-toggle {\n  color: "+p.get("linkColor")+";\n}\n.folder-tree { \n  background-color: "+p.get("treeBgColor")+";\n  color: "+p.get("treeFgColor")+";\n}\n.btn-primary, .btn-primary:hover, .btn-primary:focus, .primary-action .btn.btn-primary, .feedback-button {\n  background-color: "+p.get("linkColor")+" !important;\n  border-color: "+p.get("linkColor")+";\n}\n.list-view.visible-selection .list-item.selected i.fa,\n.mail-item.visible-selection .selected .thread-size { color: rgba(255, 255, 255, 0.5); }\n.io-ox-office-main.io-ox-office-edit-main>.view-pane.top-pane { background-color: "+p.get("officebarColor")+"; }\n")},50);p.on("change:topbarSize change:topbarColor1 change:topbarColor2 change:selectionColor change:linkColor change:topbarGradient change:officebarColor change:treeFgColor change:treeBgColor",u),p.on("change:topbarSize",i),p.on("change:productName",function(o,e){e=_.escape(e).replace(/\*\*([^*]+)\*\*/g,"<b>$1</b>").replace(/\*([^*]+)\*/g,"<i>$1</i>").replace(/\|\|\|([^|]+)\|\|\|/g,'<span style="color: rgba(0, 0, 0, 0.5);">$1</span>').replace(/\|\|([^|]+)\|\|/g,'<span style="color: rgba(255, 255, 255, 0.5);">$1</span>').replace(/\|([^|]+)\|/g,'<span style="opacity: 0.5;">$1</span>');var t=$("#io-ox-top-productname");t.length||(t=$('<div id="io-ox-top-productname">').insertBefore("#io-ox-top-logo")),t.html(e)}),p.on("change:showLogo",function(o,e){$("#io-ox-top-logo").css("display",!0===e?"inline-block":"none")}),p.on("change:url",function(o,e){f=e,r()}),p.on("change",function(o){_(o.changed).each(function(o,e){var t=n.filter('[data-name="'+e+'"]'),a=t.val();"checkbox"===t.attr("type")?t.prop("checked",o):a!==o&&t.val(o)}),t.set("presets/default",o.toJSON()).save()});var g,b=function(o){var e=_.extend({},s,c[d=o]);p.set(e)},f="";n.filter('[type="color"]').on("change",function(){p.set($(this).data("name"),$(this).val())}),n.filter('[data-name="topbarSize"]').on("input",function(){var o=parseInt($(this).val(),10);p.set("topbarSize",o)}),n.filter('[data-name="topbarGradient"]').on("input",function(){var o=parseInt($(this).val(),10);p.set("topbarGradient",o)}),n.filter('[data-name="productName"]').on("input",function(){var o=$(this).val();p.set("productName",o)}),n.filter('[data-name="showLogo"]').on("change",function(){var o=$(this).prop("checked");p.set("showLogo",o)}),$('#customize-dialog input[type="file"]').on("change",function(){var o=this.files[0];if(o&&o.type.match(/image.*/)){var e=new FileReader;e.onload=function(){(f=e.result).length<=55296?p.set("url",f):r(),o=e=null},e.readAsDataURL(o)}}),$("#customize-dialog .clear-logo").on("click",function(){f="",p.set("url",""),p.set("showLogo",!1)}),$("#customize-dialog .apply-preset").on("click",function(o){o.preventDefault();var e=d+(o.shiftKey?-1:1);b(e=(c.length+e)%c.length)}),$("#customize-dialog .reset-model").on("click",function(o){o.preventDefault(),p.clear(),f="",r()}),$("#customize-dialog .store-model").on("click",function(e){e.preventDefault(),Modernizr.localstorage&&(localStorage.setItem("customize/clipboard",JSON.stringify(p.toJSON())),o.yell({type:"success",message:'Current customizations have been stored in your local browser cache. You can login with another user and use "Restore" to share customizations across different users.',duration:-1}))}),$("#customize-dialog .restore-model").on("click",function(o){if(o.preventDefault(),Modernizr.localstorage){var e=localStorage.getItem("customize/clipboard");e&&p.set(JSON.parse(e))}}),new e("io.ox/core/stages",{id:"customize-banner",before:"curtain",run:function(){var o=t.get("presets/default",{});_.isEmpty(o)?b(0):p.set(o),u(),_.delay(i,2e3)}}),window.customize={model:p,colors:function(){console.log("{ topbarColor1: '%s', topbarColor2: '%s', selectionColor: '%s', linkColor: '%s'",p.get("topbarColor1"),p.get("topbarColor2"),p.get("selectionColor"),p.get("linkColor"))},reset:function(){b(0),t.set("presets/default",{}).save()},toggle:function(){$("#customize-dialog").modal("toggle")}}}});