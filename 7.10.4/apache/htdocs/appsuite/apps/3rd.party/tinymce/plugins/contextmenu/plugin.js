!function(){"use strict";var t=function(e){var n=e,o=function(){return n};return{get:o,set:function(t){n=t},clone:function(){return t(o())}}},e=tinymce.util.Tools.resolve("tinymce.PluginManager"),n={get:function(t){return{isContextMenuVisible:function(){return t.get()}}}},o={shouldNeverUseNative:function(t){return t.settings.contextmenu_never_use_native},getContextMenu:function(t){return t.getParam("contextmenu","link openlink image inserttable | cell row column deletetable")}},u=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),r=function(t){return u.DOM.select(t.settings.ui_container)[0]},i=function(t,e){return{x:t,y:e}},c=function(t,e,n){return i(t.x+e,t.y+n)},s=function(t){return i(t.pageX,t.pageY)},l=function(t){return i(t.clientX,t.clientY)},a=function(t,e){if(t&&"static"!==u.DOM.getStyle(t,"position",!0)){var n=u.DOM.getPos(t),o=n.x-t.scrollLeft,r=n.y-t.scrollTop;return c(e,-o,-r)}return c(e,0,0)},f=function(t,e){var n=u.DOM.getPos(t);return c(e,n.x,n.y)},g={getPos:function(t,e){if(t.inline)return a(r(t),s(e));var n=f(t.getContentAreaContainer(),l(e));return a(r(t),n)}},m=tinymce.util.Tools.resolve("tinymce.ui.Factory"),v=tinymce.util.Tools.resolve("tinymce.util.Tools"),x=function(t,e){var n,u,i=[];u=o.getContextMenu(t),v.each(u.split(/[ ,]/),function(e){var n=t.menuItems[e];"|"===e&&(n={text:e}),n&&(n.shortcut="",i.push(n))});for(var c=0;c<i.length;c++)"|"===i[c].text&&(0!==c&&c!==i.length-1||i.splice(c,1));return n=m.create("menu",{items:i,context:"contextmenu",classes:"contextmenu"}),n.uiContainer=r(t),n.renderTo(r(t)),n.on("hide",function(t){t.control===this&&e.set(!1)}),t.on("remove",function(){n.remove(),n=null}),n},y={show:function(t,e,n,o){null===o.get()?o.set(x(t,n)):o.get().show(),o.get().moveTo(e.x,e.y),n.set(!0)}},h=function(t,e){return e.ctrlKey&&!o.shouldNeverUseNative(t)},p={setup:function(t,e,n){t.on("contextmenu",function(o){h(t,o)||(o.preventDefault(),y.show(t,g.getPos(t,o),e,n))})}};e.add("contextmenu",function(e){var o=t(null),u=t(!1);return p.setup(e,u,o),n.get(u)})}();