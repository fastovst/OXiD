define("plugins/portal/oxdriveclients/register",["io.ox/core/extensions","gettext!plugins/portal","io.ox/core/capabilities","settings!plugins/portal/oxdriveclients","less!plugins/portal/oxdriveclients/style"],function(e,o,t,i){"use strict";function n(){var e=_.device("android"),t=_.device("ios"),i=_.device("macos");return _.device("windows")?"Windows":e?"Android":t?"iOS":i?"Mac OS":o("your platform")}function s(){var e=_.device("android"),o=_.device("ios"),t=_.device("macos");return _.device("windows")?["Android","iOS","Mac OS"]:e?["Windows","iOS","Mac OS"]:o?["Mac OS","Windows","Android"]:t?["iOS","Android","Windows"]:["Android","iOS","Mac OS","Windows"]}function a(e,t){var n=ox.language.split("_")[0],s=i.get("l10nImages"),a=ox.abs+ox.root+"/apps/plugins/portal/oxdriveclients/img/",r=e.toLowerCase();if(-1===_.indexOf(s,n)&&(n="en"),r.match(/android|ios|mac os/)){"mac os"===r&&(r="mac_os");var d=$('<div class="oxdrive-shop-image '+r+'">').css("background-image","url("+a+n+"_"+r+".png)");return $('<a class="shoplink" target="_blank" rel="noopener">').attr("href",t).append(d,$('<span class="sr-only">').text(o.format(o("Download the %s client for %s"),i.get("productName"),r)))}return"windows"===r?[$('<i class="fa fa-download" aria-hidden="true">'),$.txt(" "),$('<a class="shoplink" target="_blank" rel="noopener">').attr("href",ox.apiRoot+t+"?session="+ox.session).text(o.format(o("Download %s"),i.get("productName")))]:$()}function r(){return $('<div class="appicon" aria-hidden="true">').css("background-image",i.get("appIconAsBase64"))}function d(e){var t=n(),s=a(t,i.get("linkTo/"+t));return""===i.get("linkTo/"+t)&&(console.warn('OX Drive for windows settings URL not present! Please configure "plugins/portal/oxdriveclients/linkTo/Windows" correctly'),s=$('<p style="font-weight: bold">').text(o.format(o('Please use the "Connect your device" wizard to download %s'),i.get("productName")))),$('<ul class="oxdrive content pointer list-unstyled">').append($('<li class="first">').append(r()),$('<li class="message">').append($("<h3>").text(e.message)),$('<li class="teaser">').text(e.teaser),$('<li class="link">').append(s))}e.point("io.ox/portal/widget/oxdriveclients").extend({title:o.format(o("Get %s"),i.get("productName")),load:function(e){var t=$.Deferred();return e.message=o.format(o("Download %s for %s now"),i.get("productName"),n()),e.teaser=o.format(o("The %s client lets you store and share your photos, files, documents and videos, anytime, anywhere. Access any file you save to %s from all your computers, iPhone, iPad or from within %s itself."),i.get("productName"),i.get("productName"),ox.serverConfig.productName),e.link=i.get("linkTo/"+n()),t.resolve()},preview:function(e){this.append(d(e))},draw:function(e){var t=d(e);this.append(t),t.append($("<li>").append($("<h3>").text(o.format(o("%s is also available for other platforms:"),i.get("productName"))))),_.each(s(),function(e){""!==i.get("linkTo/"+e)&&t.append($('<li class="link">').append(a(e,i.get("linkTo/"+e))))})}}),e.point("io.ox/portal/widget/oxdriveclients/settings").extend({title:o.format(o("Get %s"),i.get("productName")),type:"oxdriveclients",editable:!1,unique:!0})});