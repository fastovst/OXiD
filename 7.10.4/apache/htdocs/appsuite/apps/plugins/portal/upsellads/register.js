define("plugins/portal/upsellads/register",["io.ox/core/extensions","gettext!plugins/portal","settings!plugins/upsell","less!plugins/portal/upsellads/style"],function(e,t,s){"use strict";var l,n,a,i={},o=s.get("ads/delayInMilliseconds",5e3),r=0;a=function(e){var t,s,l,n=[];{if(e.slides&&!_(e.slides).isEmpty())return s=_(e.slides).keys(),t=_(s).contains(ox.language)?e.slides[ox.language]:e.slides[s[0]],l=_(t).keys().sort(),_(l).each(function(e){n.push(t[e])}),n;console.error("No slides present",e)}},l=function(e,t){var s;e&&e.type?(s=e.type)&&"text-only"!==s?"text-top"===s?t.append($('<div class="text upsell-top">').html(e.text),$('<div class="image upsell-bottom">').css({"background-image":"url("+e.image+")"})):"text-bottom"===s?t.append($('<div class="image upsell-top">').css({"background-image":"url("+e.image+")"}),$('<div class="text upsell-bottom">').html(e.text)):"image-only"===s?t.append($('<div class="image upsell-full">').css({"background-image":"url("+e.image+")"})):console.error('Do not know type "'+s+'"',e,t):t.append($('<div class="text upsell-full">').append($('<div class="overflow-container">').html(e.text))):console.error("No type set",e,t)},n=function(e,t,s){r=(r+1)%s.length,e.empty(),l(s[r],e),clearInterval(i[t]),i[t]=setInterval(function(){return n(e,t,s)},o)},e.point("io.ox/portal/widget/upsellads").extend({title:"Upsell Ads",preview:function(e){var t,r=$('<div class="content">').appendTo(this),p=e.model.get("props").ad,d=s.get("ads/"+p),c=s.get(p+".position",0);d?(t=a(d),r.parent().addClass("upsellads-widget"),r.parent().find("h2").remove(),r.parent().append($('<div class="upsellads-next">').on("click",function(){return n(r,p,t)}).append($('<i class="fa fa-circle-arrow-right fa-2x" aria-hidden="true">'))),r.on("click",function(){var e=$.Deferred();require(["io.ox/wizards/upsell"],function(t){t.getInstance().start({cssClass:"upsell-wizard-container"}).done(function(){}).fail(e.reject)})}),l(t[c],r),i[p]=setInterval(function(){return n(r,p,t)},o)):r.parent().remove()}})});