define("plugins/xing/main",["io.ox/core/extPatterns/stage","io.ox/core/extensions","io.ox/xing/api","io.ox/backbone/views/actions/util","io.ox/core/notifications","io.ox/keychain/api","gettext!plugins/portal"],function(i,n,e,o,t,a,s){"use strict";var r,l,c=o.Action,d=s("XING");l=function(){return a.isEnabled("xing")&&a.hasStandardAccount("xing")},r=function(i){return e.findByMail(i).then(function(i){return!!i.results&&_(i.results.items).some(function(i){return!!i.user})})},new c("io.ox/xing/actions/invite",{id:"invite-xing",capabilities:"xing",requires:function(i){var n=i.baton.data,e=_.compact([n.email1,n.email2,n.email3]),o=$.Deferred();return l()&&i.collection.has("one")&&!n.mark_as_distributionlist?(r(e).done(function(i){o.resolve(!i)}).fail(function(){o.resolve(!1)}),o):(o.resolve(!1),o)},action:function(i){var n=i.data;e.invite({email:n.email1||n.email2||n.email3}).fail(function(i){t.yell("error",s('There was a problem with %s. The error message was: "%s"',d,i.error))}).done(function(){t.yell("success",s("Invitation sent"))})}}),new c("io.ox/xing/actions/add",{id:"add-on-xing",capabilities:"xing",requires:function(i){var n=i.baton.data,e=_.compact([n.email1,n.email2,n.email3]),o=$.Deferred();return l()?(r(e).done(function(i){o.resolve(i)}).fail(function(){o.resolve(!1)}),o):(o.resolve(!1),o)},action:function(i){var n=i.data;e.initiateContactRequest({email:n.email1||n.email2||n.email3}).fail(function(i){t.yell("error",s('There was a problem with %s. The error message was: "%s"',d,i.error))}).done(function(){t.yell("success",s("Contact request sent"))})}}),new i("io.ox/core/stages",{id:"xing-toolbar-addons",index:1001,run:function(){return n.point("io.ox/contacts/links/inline").extend({id:"invite-contact-to-xing",index:610,title:s("Invite to %s",d),ref:"io.ox/xing/actions/invite"}),n.point("io.ox/mail/all/actions").extend({id:"invite-email-to-xing",index:310,title:s("Invite to %s",d),ref:"io.ox/xing/actions/invite"}),n.point("io.ox/contacts/toolbar/links").extend({id:"invite-contact-to-xing-classic",prio:"lo",mobile:"lo",title:s("Invite to %s",d),ref:"io.ox/xing/actions/invite"}),n.point("io.ox/contacts/links/inline").extend({id:"add-on-xing-by-contact",index:610,title:s("Add on %s",d),ref:"io.ox/xing/actions/add"}),n.point("io.ox/mail/all/actions").extend({id:"add-on-xing-by-e-mail",index:310,title:s("Add on %s",d),ref:"io.ox/xing/actions/add"}),n.point("io.ox/contacts/toolbar/links").extend({id:"add-on-xing-by-contact-classic",prio:"lo",mobile:"lo",title:s("Add on %s",d),ref:"io.ox/xing/actions/add"}),$.when()}})});