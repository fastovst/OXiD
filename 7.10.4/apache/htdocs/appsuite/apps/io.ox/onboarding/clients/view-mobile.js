define("io.ox/onboarding/clients/view-mobile",["io.ox/core/extensions","io.ox/backbone/views/modal","io.ox/onboarding/clients/config","io.ox/onboarding/clients/api","io.ox/core/a11y","settings!io.ox/core","gettext!io.ox/core/onboarding"],function(i,t,e,n,a,o,s){"use strict";function d(i){i.preventDefault();var t=$(i.target).closest(".scenario"),e=t.attr("data-missing-capabilities");e&&require(["io.ox/core/upsell"],function(i){i.enabled(e.replace(/,/g," "))&&i.trigger({type:"custom",id:t.attr("data-id"),missing:e})})}var r="io.ox/onboarding/clients/views/mobile",c={scenario:function(i,t,e){return[$('<article class="scenario">').attr({"data-id":i.id,"data-missing-capabilities":i.missing_capabilities}).append($('<h2 class="title">').text(i.name||""),$('<p class="description">').text(i.description),$('<div class="actions">').append(_.map(i.actions,_.partial(c.action,i)))),t!==e.length-1?$('<hr class="divider">'):$()]},action:function(t,e,n){var a=$('<section class="action">').attr("data-action",e.id).attr({"data-index":n}),o=e.id.split("/")[0];return i.point(r+"/"+o).invoke("draw",a,e,t),a},block:function(i){this.append($('<pre class="config">').append($("<div>").append(_.map(i.data,function(i){var t=!("value"in i);return $('<div class="property">').addClass(t?"title":"").text(i.name+(t?"":":"))})),$("<div>").append(_.map(i.data,function(i){var t=!("value"in i);return $('<div class="value">').text(t?"Â ":i.value).addClass(t?"title":"")}))))},toggle:function(){if("0"!==this.attr("data-index")){var i=$('<a href="#" role="button" class="inline-link">'),t=$("<div>").append(this.find(".config"));a.collapse(i,t,{onChange:function(t){return/(show)/.test(t)?i.text(s("Hide details")):/(hide)/.test(t)?i.text(s("Show details")):void 0}}),this.empty().append(i,t)}},titleDownload:function(){this.append($('<h3 class="title">').text(s("Automatic Configuration")))},descriptionDownload:function(i){this.append($('<p class="description">').text(i.description))},buttonDownload:function(i){var t=_.uniqueId("description-");this.append($('<button type="button" class="btn btn-primary action-call">').attr("aria-describedby",t).text(s("Install")).on("click",function(t){t.preventDefault();var a=n.getUrl(i.scenario,i.id,e.getDevice().id);require(["io.ox/core/download"],function(i){i.url(a)})}))},descriptionLink:function(i){this.append($('<p class="description">').append(i.description?i.description+" ":"",i.store?i.store.description:""))},imageLink:function(i){(i.image||i.imageplaceholder)&&this.find(".description").prepend($('<a class="app" target="_blank">').attr("href",i.link).append($('<img class="app-icon action-call" role="button">').attr({src:i.image||i.imageplaceholder})))},badge:function(i){i.store.image&&this.append($('<a class="store" target="_blank">').attr("href",i.link).append($('<img class="store-icon action-call" role="button">').attr({"data-detail":i.store.name,src:i.store.image})))},premium:function(i,t){if(!t.enabled&&o.get("features/upsell/client.onboarding/enabled",!0)){var e,n,a=$('<div class="premium-container">'),r=o.get("features/upsell/client.onboarding/color"),c=o.get("features/upsell/client.onboarding/icon")||o.get("upsell/defaultIcon");a.append($('<div class="premium">').append(e=$("<span>").text(s("Premium")),n=$('<i class="fa">'))),r&&e.css("color",r),c&&n.addClass(c),a.on("click",d),this.append(a)}}};return i.point(r+"/display").extend({id:"premium",draw:c.premium},{id:"block",draw:c.block},{id:"toggle",draw:c.toggle}),i.point(r+"/download").extend({id:"premium",draw:c.premium},{id:"title",draw:c.titleDownload},{id:"description",draw:c.descriptionDownload},{id:"button",draw:c.buttonDownload}),i.point(r+"/link").extend({id:"premium",draw:c.premium},{id:"description",draw:c.descriptionLink},{id:"imageLink",draw:c.imageLink},{id:"badge",draw:c.badge}),i.point(r+"/email").extend({draw:$.noop}),i.point(r+"/sms").extend({draw:$.noop}),{extensions:c,get:function(){return new t({title:s("Connect this device"),point:"io.ox/onboarding/clients/views/mobile",maximize:!1}).extend({layout:function(){this.$el.addClass("client-onboarding mobile")},"action-close":function(){this.$el.find(".modal-header").append($('<a href="#" class="modal-action close" data-action="cancel" role="button">').attr("aria-label",s("Close")).append($('<i class="fa fa-times" aria-hidden="true">').attr("title",s("Close"))).on("click",this.close))},content:function(){var i=_.map(e.getScenarios(),function(i){return _.extend(i,{actions:e.getActions(i.id)})});this.$body.append(_(i).chain().map(c.scenario).flatten().value())}})}}});