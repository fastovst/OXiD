define("io.ox/files/settings/pane",["io.ox/core/extensions","io.ox/backbone/views/extensible","io.ox/core/capabilities","io.ox/backbone/mini-views","io.ox/core/settings/util","settings!io.ox/files","gettext!io.ox/files"],function(e,i,t,n,a,s,l){"use strict";if(!t.has("guest")){s.on("change",function(){s.saveAndYell()}),s.on("change:showHidden",function(){require(["io.ox/core/folder/api"],function(e){e.refresh()})}),e.point("io.ox/files/settings/detail").extend({index:100,id:"view",draw:function(){this.append(new i({point:"io.ox/files/settings/detail/view",model:s}).inject({getUploadOptions:function(){return[{label:l("Add new version"),value:"newVersion"},{label:l("Add new version and show notification"),value:"announceNewVersion"},{label:l("Add separate file"),value:"newFile"}]},getAutoPlayOptions:function(){return[{label:l("Show all images just once"),value:"loopOnceOnly"},{label:l("Repeat slideshow"),value:"loopEndlessly"}]},getAutoPlayPauseOptions:function(){return _.map([3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,25,30,35,40,50,60],function(e){return e=String(e),{value:e,label:l("%1$d seconds",e)}})},getRetentionDaysOptions:function(e){var i=[{label:l("Forever"),value:0},{label:l("1 day"),value:1},{label:l("7 days"),value:7},{label:l("30 days"),value:30},{label:l("60 days"),value:60},{label:l("90 days"),value:90},{label:l("1 year"),value:365}];return _.findWhere(i,{value:e})||i.unshift({label:l.format(l.ngettext("%1$d day","%1$d days",e),e),value:e}),i},getMaxVersionsOptions:function(e){var i=[{label:l("Keep all versions"),value:0},{label:l("1 version"),value:2},{label:l("5 versions"),value:6},{label:l("10 versions"),value:11},{label:l("20 versions"),value:21},{label:l("30 versions"),value:31},{label:l("40 versions"),value:41},{label:l("50 versions"),value:51},{label:l("60 versions"),value:61},{label:l("70 versions"),value:71},{label:l("80 versions"),value:81},{label:l("90 versions"),value:91},{label:l("100 versions"),value:101}];return _.findWhere(i,{value:e})||i.unshift({label:l.format(l.ngettext("%1$d version","%1$d versions",e-1),e-1),value:e}),i}}).render().$el)}});var o=0;e.point("io.ox/files/settings/detail/view").extend({id:"header",index:o+=100,render:function(){this.$el.addClass("io-ox-drive-settings").append(a.header(l.pgettext("app","Drive")))}},{id:"upload",index:o+=100,render:function(){this.$el.append(a.fieldset(l("Adding files with identical names"),new n.CustomRadioView({name:"uploadHandling",model:s,list:this.getUploadOptions()}).render().$el))}},{id:"autoplay",index:o+=100,render:function(){this.$el.append(a.fieldset(l("Slideshow / Autoplay mode for images"),$('<div class="form-group">').append(new n.CustomRadioView({name:"autoplayLoopMode",model:s,list:this.getAutoPlayOptions()}).render().$el)).css("margin-bottom","0"),$('<fieldset style="padding-top:0">').append(a.compactSelect("autoplayPause",l("Duration per image"),s,this.getAutoPlayPauseOptions(),{width:3})))}},{id:"advanced",index:o+=100,render:function(){s.isConfigurable("showHidden")&&this.$el.append(a.fieldset(l("Advanced settings"),a.checkbox("showHidden",l("Show hidden files and folders"),s)))}},{id:"versionCleanup",index:o+=100,render:function(){var e=s.get("features/autodelete/retentionDays"),i=s.get("features/autodelete/maxVersions"),n=s.get("features/autodelete/editable");if(t.has("autodelete_file_versions")){var o=$("<div>").addClass("help-block");this.getSummary=function(){var t=$("<ul>"),n=$("<span>").text(l("Summary")).append(t);return i<=0&&e<=0?(t.append($("<li>").text(l("All file versions are retained"))),n):(e>0&&t.append($("<li>").append(l.format(l.ngettext("All file versions older than 1 day will be deleted after next login","All file versions older than %1$d days will be deleted after next login",e),e))),i>0&&t.append($("<li>").append(l.format(l.ngettext("When a file has more than 1 additional version, older versions will be deleted when a new version is created","When a file has more than %1$d additional versions, older versions will be deleted when a new version is created",i-1),i-1))),n)},this.$el.append(a.fieldset(l("File version history"),$("<span>").append(l("Timeframe")),a.compactSelect("features/autodelete/retentionDays",l("Keep saved versions"),s,this.getRetentionDaysOptions(e),{width:4,integer:!0}),$("<span>").append(l("File version limit")),a.compactSelect("features/autodelete/maxVersions",l("Keep number of recent versions"),s,this.getMaxVersionsOptions(i),{width:4,integer:!0}),o.append(this.getSummary()))),n||(this.$el.find("#settings-features\\/autodelete\\/retentionDays").attr("disabled",!0),this.$el.find("#settings-features\\/autodelete\\/maxVersions").attr("disabled",!0)),this.listenTo(s,"change:features/autodelete/maxVersions change:features/autodelete/retentionDays",function(){e=s.get("features/autodelete/retentionDays"),i=s.get("features/autodelete/maxVersions"),o.empty().append(this.getSummary())}).bind(this)}else{if(!e&&!i)return;this.$el.append(a.fieldset(l("File version history"),$("<span>").append(l("Timeframe")),$("<ul>").append($("<li>").append(e<=0?l("The timeframe is not limited"):l.format(l.ngettext("The timeframe is limited to 1 day.","The timeframe is limited to %1$d days.",e),e))),$("<span>").append(l("File version limit")),$("<ul>").append($("<li>").append(i<=0?l("The number of versions is not limited"):l.format(l.ngettext("The number of versions is limited to 1 version.","The number of versions is limited to %1$d versions.",i-1),i-1)))))}}})}});