define("io.ox/chat/views/channelList",["io.ox/backbone/views/disposable","io.ox/chat/views/chatAvatar","io.ox/chat/data"],function(e,t,n){"use strict";return e.extend({className:"channel-list abs",initialize:function(){this.collection=n.chats,this.listenTo(this.collection,{add:this.onAdd,remove:this.onRemove,"change:joined":this.onChangeJoined,"change:title":this.onChangeTitle}),this.collection.fetch({remove:!1,data:{type:"channel"}})},render:function(){return this.$el.append($('<div class="header abs">').append($("<h2>").append("All channels")),$('<div class="scrollpane abs">').append($("<ul>").append(this.getItems().map(this.renderItem,this)))),this},renderItem:function(e){return $('<li class="channel">').append($("<div>").append(new t({model:e}).render().$el,$('<span class="title">').text(e.getTitle()),$('<span class="members">').text((e.get("members")||[]).length+" member(s)")),$('<div class="description">').text(e.get("description")),$('<button type="button" class="btn btn-default btn-action join" >').attr({"data-cmd":"join-channel","data-id":e.get("id")}).text("Join"))},getItems:function(){return this.collection.getChannelsUnjoined()},getNode:function(e){return this.$('[data-id="'+$.escape(e.get("id"))+'"]')},onAdd:_.debounce(function(){this.$("ul").empty().append(this.getItems().map(this.renderItem.bind(this)))},1),onRemove:function(e){this.getNode(e).remove()},onChangeJoined:function(e){this.onRemove(e)},onChangeTitle:function(e){this.getNode(e).find(".title").text(e.getTitle())}})});