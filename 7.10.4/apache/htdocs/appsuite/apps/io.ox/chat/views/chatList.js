define("io.ox/chat/views/chatList",["io.ox/backbone/views/disposable","io.ox/chat/views/state","io.ox/chat/data"],function(e,t){"use strict";return e.extend({className:"chats",initialize:function(){this.listenTo(this.collection,{add:this.onAdd,remove:this.onRemove,"change:title":this.onChangeTitle,"change:unseen":this.onChangeUnseen,"change:modified":this.onChangeModified,"change:open":this.onChangeOpen})},render:function(){return this.collection.fetch(),this},renderItem:function(e){return $('<button type="button" class="btn-nav" data-cmd="show-chat">').attr("data-cid",e.cid).toggleClass("unseen",e.get("unseen")>0).append(this.renderIcon(e),$('<span class="label label-default">').text(e.get("unseen")),$('<div class="title">').text(e.getTitle()))},renderIcon:function(e){switch(e.get("type")){case"private":return $('<span class="btn-icon">').append(new t({model:e.getFirstMember()}).render().$el.addClass("small"));case"group":return $('<i class="fa fa-group btn-icon" aria-hidden="true">');case"channel":return $('<i class="fa fa-hashtag btn-icon" aria-hidden="true">')}},getItems:function(){return this.collection.getOpen()},getNode:function(e){return this.$('[data-cid="'+e.cid+'"]')},onAdd:_.debounce(function(e,t,n){this.$el.prepend(n.changes.added.filter(function(e){return e.isOpen()}).map(this.renderItem,this))},1),onRemove:function(e){this.getNode(e).remove()},onChangeTitle:function(e){this.getNode(e).find(".title").text(e.getTitle()||"Â ")},onChangeUnseen:function(e){var t=e.get("unseen");this.getNode(e).toggleClass("unseen",t>0).find(".label").text(t)},onChangeModified:function(e){var t=this.getNode(e),n=t[0]===document.activeElement;this.$el.prepend(t),n&&t.focus()},onChangeOpen:function(e,t){t?this.$el.prepend(this.renderItem(e)):this.onRemove(e)}})});