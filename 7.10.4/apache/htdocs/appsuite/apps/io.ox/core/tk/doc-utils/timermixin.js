define("io.ox/core/tk/doc-utils/timermixin",[],function(){"use strict";function e(){function t(e,t,n){e.abort=function(i){return"pending"===e.state()&&(_.isUndefined(i)&&(i="abort"),_.isFunction(n)&&n.call(this,i),t(i)),this},e.always(function(){e.abort=function(){return this}})}function n(e){var i=_.bind(e.then,e),r=_.bind(e.abort,e);e.then=function(e,a,o,l){var u=i(e,a,o);return t(u,r,l),n(u),u},delete e.pipe}var i=this,r=[];this.createAbortablePromise=function(e,i,a){var o=e.promise();if(t(o,_.bind(e.reject,e),i),n(o),"pending"===o.state()&&(r.push(o),o.always(function(){r=_.without(r,o)}),_.isNumber(a)&&a>0)){var l=window.setTimeout(function(){"pending"===o.state()&&o.abort("timeout")},a);o.always(function(){l&&(window.clearTimeout(l),l=null)})}return i=null,o},this.executeDelayed=function(e,t){var n=Math.max(0,_.isNumber(t)?t:t&&t.delay||0),r=null,a=$.Deferred(),o=this.createAbortablePromise(a,function(){r&&(window.clearTimeout(r),r=null)});return r=window.setTimeout(function(){r=null,$.when(e.call(i)).done(_.bind(a.resolve,a)).fail(_.bind(a.reject,a))},n),o},this.repeatDelayed=function(t,n,r){function a(){var n=t.call(i,f),r=!1,a=0;n!==e.BREAK?(n=$.when(n),r="pending"===n.state(),a=r?_.now():0,n.done(function(){"pending"===h.state()&&(f+=1,!_.isNumber(c)||f<c?o(s&&r?Math.max(0,u-(_.now()-a)):u):h.resolve())}),n.fail(_.bind(h.reject,h))):h.resolve(e.BREAK)}function o(e){d=i.executeDelayed(a,e,r)}var l=Math.max(0,_.isNumber(n)?n:n&&n.delay||0),u=Math.max(0,n&&n.repeatDelay||l),c=n&&n.cycles||null,s=Boolean(n&&n.fastAsync),f=0,d=null,h=$.Deferred(),b=this.createAbortablePromise(h,function(){d&&(d.abort(),d=null)});return n&&"immediate"===n.delay?a():o(l),b},this.repeatSliced=function(t,n){var r=Math.max(10,n&&n.slice||200),a=n&&n.infoString||"",o=0,l=null,u=$.Deferred(),c=this.createAbortablePromise(u,function(){l&&(l.abort(),l=null)});return(l=this.repeatDelayed(function(){var n=_.now(),a=null;for(u.notify(o);;){if(a=t.call(i,o),o+=1,a===e.BREAK)return u.resolve(e.BREAK),e.BREAK;if(_.isObject(a)&&_.isFunction(a.promise)&&"resolved"!==a.state())return a;if(_.now()-n>=r)return}},{delay:n&&n.delay,repeatDelay:Math.max(0,n&&n.interval||10),fastAsync:!0},a)).done(_.bind(u.resolve,u)).fail(_.bind(u.reject,u)),c},this.iterateArraySliced=function(t,n,r){var a=Boolean(r&&r.reverse||!1),o=a?t.length-1:0,l=null,u=$.Deferred(),c=this.createAbortablePromise(u,function(){l&&(l.abort(),l=null)});return 0===t.length?(u.notify(1).resolve(),c):((l=this.repeatSliced(function(){if(o<0||o>=t.length)return u.resolve(),e.BREAK;var r=n.call(i,t[o],o,t);return!((o=a?o-1:o+1)<0||o>=t.length)||_.isObject(r)&&_.isFunction(r.promise)&&"resolved"!==r.state()?r:(u.resolve(),e.BREAK)},r)).done(_.bind(u.resolve,u)).fail(_.bind(u.reject,u)),l.progress(function(e){u.notify(e/t.length)}),c.done(function(){u.notify(1)}),c)},this.iterateObjectSliced=function(e,t,n){return this.iterateArraySliced(_.keys(e),function(n){if(n in e)return t.call(this,e[n],n,e)},n)},this.createSynchronizedMethod=function(t,n){function r(){if(0===o.length)return e.BREAK;var n=o[0],i=$.when(t.apply(n.ctxt,n.args)),r=n.def;return i.always(function(){o.shift()}),i.done(_.bind(r.resolve,r)).fail(_.bind(r.reject,r)),0===o.length?e.BREAK:i}function a(e){_.each(o,function(t){t.def.reject(e)})}var o=[],l=null;return function(){var e={ctxt:this,args:arguments,def:$.Deferred()};return o.push(e),l||(l=i.repeatDelayed(r,{delay:"immediate"},n).fail(a)).always(function(){l=null}),e.def.promise()}},this.createDebouncedMethod=function(e,t,n){function r(){c&&c.abort(),s&&s.abort(),c=s=null,f=!0}function a(e){function n(){r(),t.call(e)}f&&c&&(c.abort(),c=null),f&&(f=!1,window.setTimeout(function(){f=!0},0)),c||(c=i.executeDelayed(n,o,"debounced (min) "+u)),!s&&l>0&&(s=i.executeDelayed(n,l,"debounced (max) "+u))}var o=Math.max(0,n&&n.delay||0),l=Math.max(0,n&&n.maxDelay||0),u=n&&n.infoString||"",c=null,s=null,f=!0;return function(){return a(this),e.apply(this,arguments)}},this.registerDestructor(function(){for(;r.length>0;)r[0].abort();i=r=null})}return e.BREAK={},e});