define("io.ox/core/export",["io.ox/backbone/views/modal","io.ox/backbone/mini-views/common","io.ox/core/download","gettext!io.ox/core"],function(t,e,o,a){"use strict";function i(t){var e=[];switch(t){case"calendar":case"tasks":e.push({value:"ical",label:a("iCalendar")});break;case"contacts":e.push({value:"vcard",label:a("vCard")}),e.push({value:"csv",label:a("CSV")})}return e}var n={calendar:"ox.appsuite.user.sect.calendar.manage.export.html",contacts:"ox.appsuite.user.sect.contacts.manage.export.html",tasks:"ox.appsuite.user.sect.tasks.manage.export.html"};return{open:function(s,r){return new t({enter:!1,maximize:500,point:"io.ox/core/export",title:a(r.folder?"Export folder":"Export selected"),model:new Backbone.Model,module:s,params:r,help:n[s]}).extend({setup:function(t){t.formats=i(this.options.module),this.model.set("format",(_.first(t.formats)||{}).value),this.$el.addClass("export-dialog").find(".modal-content").css("height","auto")},"single-format":function(t){1===t.formats.length&&this.$body.append($("<p>").append(a("Format: %1$s",_.first(t.formats).label)))},"multi-format":function(t){if(!(t.formats.length<2)){var o=_.uniqueId("form-control-label-");this.$body.append($("<label>").attr("for",o).append($.txt(a("Format")),new e.CustomRadioView({id:o,model:this.model,name:"format",list:t.formats}).render().$el))}},"missing-format":function(t){t.formats.length||(this.$body.append(a("No export format available")),this.$footer.find('button[data-action="export"]').attr("disabled",!0).addClass("disabled"))},"distribution-lists":function(){if("contacts"===this.options.module){this.model.set("include",!0);var t=_(this.options.params.list).filter(function(t){return!t.mark_as_distributionlist});(this.options.params.folder||t.length)&&this.$body.append(new e.CustomCheckboxView({name:"include",model:this.model,label:a("Include distribution lists")}).render().$el)}},"inital-focus":function(){this.options.focus=this.$body.find("input").length>1?"input:first":".btn-primary"}}).on({export:function(){var t=_.extend({},this.options.params,this.model.toJSON());o.exported(t)}}).addCancelButton().addButton({label:a("Export"),action:"export"}).open()}}});