define("io.ox/core/viewer/views/types/videoview",["io.ox/core/viewer/views/types/baseview","gettext!io.ox/core"],function(e,i){"use strict";return e.extend({initialize:function(){this.isPrefetched=!1},render:function(){var e=$('<video controls="true" disablepictureinpicture="true" controlslist="nodownload" class="viewer-displayer-item viewer-displayer-video player-hidden">'),t=this.getPreviewUrl()||"",o=this.model.get("file_mimetype")||"";return this.$el.find("video").off(),this.$el.empty().append(e.append($("<div>").text(i("Your browser does not support the video format of this file.")))),e.on({loadeddata:this.onLoadedData.bind(this),error:this.onError.bind(this)}),e.attr({"data-src":_.unescapeHTML(t),type:o}),this},onLoadedData:function(){this.$el.idle().find(".viewer-displayer-video").removeClass("player-hidden"),this.$el.find("video")[0].play()},onError:function(){this.$el.idle().find(".viewer-displayer-video").addClass("player-hidden"),this.$el.find("div.viewer-displayer-notification").remove(),this.$el.find(".viewer-displayer-audio-video-placeholder").remove(),this.$el.append(this.displayDownloadNotification(i("Error while playing the video. Either your browser does not support the format or you have connection problems.")))},prefetch:function(){return this.isPrefetched=!0,this},show:function(){var e=this,t=this.$el.find("video"),o=this.$el.find("div.viewer-displayer-notification");return t.length>0&&o.length<1&&(o=this.createNotificationNode(i("Start video"),"fa-play-circle-o"),this.$el.append(o).one("click",function(){e.$el.busy().find("div.viewer-displayer-notification").remove(),t.attr("src",t.attr("data-src")),t[0].load()})),this},unload:function(){return this.disposeElement(),this.isPrefetched=!1,this},disposeElement:function(){var e=this.$el.find("video");0!==e.length&&(this.$el.find(".viewer-displayer-video").addClass("player-hidden"),e[0].pause(),e.removeAttr("src"),e[0].load())},onDispose:function(){this.$el.find("video").off(),this.$el.find("viewer-displayer-audio-video-placeholder").off(),this.disposeElement()}})});