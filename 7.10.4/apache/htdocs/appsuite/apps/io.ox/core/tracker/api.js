define("io.ox/core/tracker/api",["settings!io.ox/core"],function(e){"use strict";var t=_.extend({queue:[],add:_.noop},Backbone.Events),r=e.get("tracker/url");if(!r||!1===e.get("tracker/enabled"))return t;var n=1e3*window.parseInt(e.get("tracker/delay",15),10),a=e.get("tracker/brand","Default");t.add=function(e,r){r=_.extend({stat:e,brand:a},r),t.trigger("add",r),t.queue.push(r)};var u=setInterval(function(){if(0!==t.queue.length){var e=t.queue;t.queue=[],t.trigger("sync",e),$.post({url:r,contentType:"application/json",data:JSON.stringify(e),timeout:1e4}).fail(function(r){if(403===r.status)return t.trigger("forbidden"),clearInterval(u);t.trigger("fail",e),[].push.apply(t.queue,e)})}},n);return t});