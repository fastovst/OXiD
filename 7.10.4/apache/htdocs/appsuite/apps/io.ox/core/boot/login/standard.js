define("io.ox/core/boot/login/standard",["io.ox/core/boot/util","io.ox/core/boot/locale","io.ox/core/session"],function(e,o,t){"use strict";function n(n,r){var l={name:n,password:r,staySignedIn:$("#io-ox-login-store-box").prop("checked"),locale:o.getCurrentLocale(),forceLocale:o.getSelectedLocale()};if(_.url.hash("login_type")&&_.url.hash("share")&&_.url.hash("target")){var a="guest";e.isAnonymous()&&(a="anonymous"),_.extend(l,{action:a,share:_.url.hash("share"),target:_.url.hash("target")})}return t.login(l)}function r(o){var t=window.location.pathname.replace(/[^/]+$/,"")+"busy.html";e.debug("Store credentials",t),o.find('input[name="location"]').val(t).prop("disabled",!1),o.attr("target","store-credentials").submit()}return function(o){o.preventDefault();var t=$("#io-ox-login-username").val(),l=$("#io-ox-login-password").val(),a=$(this);return e.lock(),0!==$.trim(t).length||e.isAnonymous()?0!==$.trim(l).length||e.isContinue()?void n(t,l).then(function(o){a.off("submit"),e.isAnonymous()||r(a),_.url.hash({autologout:null,share:null,target:null,login_type:null,message:null,message_type:null,token:null}),o.module&&o.folder&&_.url.hash({app:"io.ox/"+o.module,folder:o.folder,id:o.item||null}),ox.trigger("login:success",o)},function(o){e.fail(o)}):e.fail({error:e.gt("Please enter your password."),code:"UI-0002"},"password"):e.fail({error:e.gt("Please enter your credentials."),code:"UI-0001"},"username")}});