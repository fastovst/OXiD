define("io.ox/core/folder/actions/properties",["io.ox/core/extensions","io.ox/core/folder/api","io.ox/core/capabilities","io.ox/backbone/views/modal","settings!io.ox/contacts","settings!io.ox/caldav","gettext!io.ox/core","io.ox/oauth/keychain","io.ox/backbone/mini-views/copy-to-clipboard"],function(e,o,t,i,n,r,a,d,c){"use strict";function l(e,o){var t=_.uniqueId("form-control-label-");return $('<div class="form-group">').append($('<label class="control-label">').attr("for",t).text(e),$('<div class="input-group link-group">').append($('<input type="text" class="form-control">').attr("id",t).prop("readonly",!0).val(o),$('<span class="input-group-btn">').append(new c({targetId:"#"+t}).render().$el)))}return e.point("io.ox/core/folder/actions/properties").extend({id:"caldav-url",index:300,render:function(){if("calendar"===this.model.get("module")){var e=(this.model.get("com.openexchange.calendar.extendedProperties")||{}).usedForSync||{};if(!e||"true"!==e.value)return}else if("tasks"!==this.model.get("module")||!t.has("caldav")||!this.model.is("private"))return;var o=this.model.get("com.openexchange.caldav.url");o&&this.$body.append(l(a("CalDAV URL"),o))}}),e.point("io.ox/core/folder/actions/properties").extend({id:"ical-url",index:400,render:function(){if("ical"===this.model.get("com.openexchange.calendar.provider")){var e=this.model.get("com.openexchange.calendar.config");e&&e.uri&&this.$body.append(l(a("iCal URL"),e.uri))}}}),e.point("io.ox/core/folder/actions/properties").extend({id:"description",index:500,render:function(){var e=this.model.get("com.openexchange.calendar.extendedProperties");e&&e.description&&e.description.value&&this.$body.append($('<div class="form-group">').append($("<label>").text(a("Description")),$('<div class="help-block">').text(e.description.value)))}}),e.point("io.ox/core/folder/actions/properties").extend({id:"last-updated",index:600,render:function(){var e=this.model.get("com.openexchange.calendar.extendedProperties");e&&e.lastUpdate&&this.$body.append($('<div class="form-group">').append($("<label>").text(a("Last updated")),$('<div class="help-block">').text(moment(e.lastUpdate.value).fromNow())))}}),e.point("io.ox/core/folder/actions/properties").extend({id:"account",index:700,render:function(){var e=this;if("google"===this.model.get("com.openexchange.calendar.provider")){var o=this.model.get("com.openexchange.calendar.config");if(o&&o.oauthId){var t=d.accounts.get(o.oauthId);if(t){var i=t.get("displayName");i&&this.$body.append($('<div class="form-group">').append($("<label>").text(a("Account")),$("<div>").append($('<a href="#" role="button">').text(i).on("click",function(o){var t={id:"io.ox/settings/accounts"};ox.launch("io.ox/settings/main",t).done(function(){this.setSettingsPane(t)}),o.preventDefault(),e.close()}))))}}}}}),e.point("io.ox/core/folder/actions/properties").extend({id:"provider",index:800,render:function(){var e={ical:a("iCal feed"),google:a("Google subscription"),schedjoules:a("Calendars of interest")};return function(){var o=this.model.get("com.openexchange.calendar.provider");o&&e[o]&&this.$body.append($('<div class="form-group">').append($("<label>").text(a("Type")),$('<div class="help-block">').text(e[o])))}}()}),function(e){var t=o.pool.getModel(e);new i({title:a("Properties")+": "+t.get("title"),point:"io.ox/core/folder/actions/properties",model:t,width:500}).addButton({label:a("Close"),action:"close"}).open()}});