define("io.ox/metrics/adapters/default",["settings!io.ox/core","io.ox/core/extensions","io.ox/metrics/util"],function(i,a,e){"use strict";if(i.get("tracking/piwik/enabled",!1)){var t=a.point("io.ox/metrics/adapter"),n=i.get("tracking/piwik/url/lib"),r=i.get("tracking/piwik/url/api"),o=i.get("tracking/piwik/id",1);window._paq=window._paq||[],r&&n||console.log("Error: Matomo/Piwik is enabled but no backend URL was configured!"),t.extend({id:"piwik",setup:function(){_paq.push(["setTrackerUrl",r]),_paq.push(["setSiteId",ox.debug?2:o]),_paq.push(["setUserId",this.getUserHash()]),_paq.push(["enableLinkTracking"]),require([n])},trackVisit:function(i){var a=this,t=[];_.each(i,function(i){var a=String(i.value);if(!_.isArray(i.value)||a.length<=200)return t.push(i);var n=e.toChunks(i.value,200);_.each(n,function(a,e){t.push(_.extend({},i,{value:a,id:i.id+"-"+(e+1)}))})}),_.each(t,function(i,e){a.trackVariable(_.extend(i,{index:e+1}))})},trackEvent:function(i){var a=i.data;_paq.push(["trackEvent",a.app,i.id||a.target,a.action,a.detail||a.value])},trackPage:function(i){_paq.push(["trackPageView",i.data.trackingId||i.data.name||i.data.id])},trackVariable:function(i){i.index?_paq.push(["setCustomVariable",i.index,i.id,String(i.value),i.scope||"visit"]):ox.debug&&console.log("Missing/invalid index argument on trackVariable call")}})}});