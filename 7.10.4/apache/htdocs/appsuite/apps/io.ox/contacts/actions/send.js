define("io.ox/contacts/actions/send",["io.ox/contacts/api","io.ox/contacts/util"],function(i,t){"use strict";function n(n){if(1===n.length&&(0===n[0].id||0===n[0].folder_id)){var e=n[0].email1||n[0].email2||n[0].email3;return $.Deferred().resolve([[e,e]])}return i.getList(n,!0,{check:function(i){return i.mark_as_distributionlist||i.email1||i.email2||i.email3}}).then(function(i){return t.validateDistributionList(_.chain(i).filter(function(i){return i.distribution_list}).map(function(i){return i.distribution_list}).flatten().value()),_.chain(i).map(function(i){return i.distribution_list&&i.distribution_list.length?_(i.distribution_list).map(function(i){return[i.display_name,i.mail]}):[[i.display_name,i.email1||i.email2||i.email3,i.image1_url]]}).flatten(!0).filter(function(i){return!!i[1]}).value()})}return function(i){return n(i).done(function(i){ox.registry.call("mail-compose","open",{to:i})})}});