define("io.ox/notes/toolbar",["io.ox/notes/api","io.ox/core/extensions","io.ox/backbone/views/actions/util","io.ox/backbone/views/toolbar","io.ox/core/notifications","gettext!io.ox/notes","io.ox/files/actions"],function(o,e,i,t,n,a){"use strict";new(0,i.Action)("io.ox/notes/actions/create",{folder:"create",action:function(e){o.create({folder:e.folder_id}).done(function(o){var i=_.cid(o),t=e.app.listView;t.listenToOnce(t.collection,"add",function(){setTimeout(function(o){o.set([i],!0)},10,this.selection)}),t.reload()}).fail(n.yell)}});var l=e.point("io.ox/notes/toolbar/links"),s={create:{prio:"hi",title:a("New note"),drawDisabled:!0,ref:"io.ox/notes/actions/create"},download:{prio:"hi",title:a("Download"),icon:"fa fa-download",drawDisabled:!0,ref:"io.ox/files/actions/download"},send:{prio:"hi",title:a("Send by mail"),icon:"fa fa-envelope-o",drawDisabled:!0,ref:"io.ox/files/actions/send",section:"share"},delete:{prio:"hi",title:a("Delete"),icon:"fa fa-trash-o",drawDisabled:!0,ref:"io.ox/files/actions/delete"}},d=0;_(s).each(function(o,e){o.id=e,o.index=d+=100,l.extend(o)}),e.point("io.ox/notes/mediator").extend({id:"toolbar",index:1e4,setup:function(e){var i=new t({point:"io.ox/notes/toolbar/links",title:e.getTitle()});e.getWindow().nodes.body.addClass("classic-toolbar-visible").prepend(i.$el),e.updateToolbar=function(e){var t={data:e.map(_.cid),folder_id:this.folder.get(),app:this};i.setSelection(t.data,function(){return t.data=o.resolve(e,!0),t})}}}),e.point("io.ox/notes/mediator").extend({id:"update-toolbar",index:10200,setup:function(o){o.updateToolbar([]),o.listView.on("selection:change change",function(){o.updateToolbar(o.listView.selection.get())})}})});