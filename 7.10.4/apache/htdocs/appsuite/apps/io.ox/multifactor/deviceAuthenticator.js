define("io.ox/multifactor/deviceAuthenticator",["io.ox/multifactor/api","io.ox/core/extensions","io.ox/multifactor/views/constants"],function(e,i,o){"use strict";function r(e,r){var t=e.challenge;switch(r.providerName){case o.TOTP:require(["io.ox/multifactor/views/totpProvider"],function(e){e.open(t,r)});break;case o.SMS:require(["io.ox/multifactor/views/smsProvider"],function(e){e.open(t,r)});break;case o.U2F:require(["io.ox/multifactor/views/u2fProvider"],function(e){e.open(t,r)});break;case"WEB-AUTH":require(["io.ox/multifactor/views/webAuthProvider"],function(e){e.open(t,r)});break;case o.BACKUP:require(["io.ox/multifactor/views/backupProvider"],function(e){e.open(t,r)});break;default:var n=new i.Baton({data:{challengeData:t,authInfo:r}});i.point("io.ox/multifactor/device/"+r.providerName).invoke("auth",this,n).any()||r.def.reject()}}function t(e){return e.providerName!==o.SMS||(e.error?!(e.device.id===n.id&&++a<3)&&(n=e.device,a=0,!0):(n=e.device,a=0,!0))}var n,a,c;return{getAuth:function(i){t(i)?e.beginAuth(i.providerName,i.device.id).then(function(e){c=e,r(e,i)},i.def.reject):(i.error.repeat=!0,r(c,i))}}});