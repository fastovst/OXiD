define("io.ox/multifactor/settings/views/addMultifactorView",["io.ox/backbone/views","io.ox/core/extensions","io.ox/backbone/mini-views","io.ox/backbone/views/modal","io.ox/core/yell","io.ox/multifactor/api","io.ox/multifactor/views/constants","gettext!io.ox/core/boot","less!io.ox/multifactor/style","io.ox/multifactor/auth"],function(e,t,o,i,a,n,c,r){"use strict";function s(e,t){return new i({async:!0,point:f,title:r(t?"Add Recovery Option":"Add Verification Option"),enter:"add",model:new Backbone.Model({providers:e,backup:t})}).build(function(){}).on("cancel",function(){l.reject()}).addButton().open()}function d(e,o){var i,a;switch(e.name){case c.SMS:i=c.SMS_ICON,a=r("Code via text message");break;case"WEB-AUTH":a=r("Use a FIDO2 compatible device to authenticate your identity."),i="fa-microchip";break;case c.U2F:if(!window.u2f)return;a=r("Yubikey, Google Security Keys, or compatible FIDO device"),i=c.U2F_ICON;break;case"YUBIKEY":a=r("Use Yubikey's One Time Password System"),i="fa-id-badge";break;case c.TOTP:a=r("Google Authenticator or compatible"),i=c.TOTP_ICON;break;case c.BACKUP:a=r("Backup code to access your account."),i=c.BACKUP_ICON;break;default:var n=new t.Baton;t.point("io.ox/multifactor/addDevice/"+e.name).invoke("render",this,n),n.data.text?(a=n.data.text,i=n.data.icon):(a=r("Unknown system"),i="fa-error")}var s=$('<li class="settings-list-item multifactordeviceSelectable">').attr("title",a).on("click",function(t){u(e.name,o),t.preventDefault()}),d=$('<i class="fa '+i+' mfIcon">'),l=$('<span style="max-width:90%">').append(a);return s.append(d).append(l)}function u(e,t){require(["io.ox/multifactor/settings/views/addDevice"],function(o){o.start(e,l,t)}),p.close()}var l,p,f="multifactor/settings/addMultifactor",b=0;return t.point(f).extend({index:b+=100,id:"backupHelp",render:function(e){if(e.model.get("backup")){var t=$('<p class="backupDescr">').append(r("In the event you lose or are unable to use your authentication device, your account will be locked out unless you set up a recovery method. We strongly recommend that you do so now.")).append("<br>");this.$body.append(t)}}},{index:b+=100,id:"selector",render:function(e){var t=e.model.get("providers");if(t&&0!==t.length){var o=this,i=$('<ul class="list-group list-unstyled settings-list-view mfAddDevice">');t.forEach(function(t){i.append(d(t,e.model.get("backup")))}),o.$body.append(i)}else this.$body.append($("<div>").append(r("No providers available")))}}),{open:function(e,t){return p=s(e,t),l=new $.Deferred}}});