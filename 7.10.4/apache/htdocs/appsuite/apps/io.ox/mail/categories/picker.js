define("io.ox/mail/categories/picker",["io.ox/mail/categories/api","io.ox/backbone/mini-views/dropdown","io.ox/backbone/views/actions/util","gettext!io.ox/mail"],function(e,t,o,i){var n=t.extend({tagName:"li",renderMenu:function(e){this.$ul.empty(),this.props=e.props;var t=[].concat(e.data);this.addCategories(t),this.addLinks(t)},addCategories:function(t){var o=this.props.get("category_id"),n=e.collection.filter(function(e){return e.isEnabled()&&e.id!==o});n.length&&(this.header(i("Move to category")),_.each(n,function(e){this.link(e.id,e.get("name"),$.proxy(this.onCategory,this,t))}.bind(this)),this.divider())},addLinks:function(e){this.link("move-to-folder",i("Move to folder")+" â€¦",$.proxy(this.onLink,this,e))},onCategory:function(t,o){var i=$(o.currentTarget),n=i.attr("data-name")||"0",a=i.text(),r=this.props.get("category_id");e.move({data:t,source:r,sourcename:e.collection.get(r).get("name"),target:n,targetname:a})},onLink:function(e){o.invoke("io.ox/mail/actions/move",e)}});return{appendDropdown:function(e,t){e.addClass("dropdown-toggle"),e.parent().addClass("dropdown categories"),new n({el:e.parent(),$toggle:e}).render().renderMenu(t)},attach:function(e,t){this.appendDropdown(e,t)}}});