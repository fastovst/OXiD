define("io.ox/mail/sanitizer",["settings!io.ox/mail","static/3rd.party/purify.min.js"],function(e,t){var i=e.get("whitelist",{}),n=["desktop","mobile","tablet","id","class","style"],s={SAFE_FOR_JQUERY:!0,FORCE_BODY:!0,WHOLE_DOCUMENT:!0},a=function(e){switch(e.type){case 1:return(e.cssText.indexOf(".mail-detail-content ")>-1?"":".mail-detail-content ")+e.cssText;case 4:var t="";return _(e.cssRules).each(function(e){t=t+a(e)+" "}),"@media "+e.media.mediaText+"{ "+t+"}";default:return e.cssText}};return _.isEmpty(i)?(console.error('Sanitizer: No whitelist defined in "io.ox/mail//whitelist". HTML sanitizer will not work correctly.'),s.ADD_ATTR=["desktop","mobile","tablet"]):(s.ALLOWED_ATTR=n.concat(i.allowedAttributes||[]),s.ALLOWED_TAGS=i.allowedTags),t.addHook("beforeSanitizeElements",function(e){if("TITLE"===e.tagName&&(e.innerHTML=""),"STYLE"===e.tagName&&e.sheet&&e.sheet.cssRules){var t="";_(e.sheet.cssRules).each(function(e){t=t+a(e)+" "}),e.innerHTML=t}return e}),{sanitize:function(e,i){return i=_.extend({},s,i),"text/html"!==e.content_type?e:(e.content=t.sanitize(e.content,i)+"",e)},simpleSanitize:function(e){return t.sanitize(e,_.extend({},s,{WHOLE_DOCUMENT:!1}))+""},isEnabled:function(){return!0}}});