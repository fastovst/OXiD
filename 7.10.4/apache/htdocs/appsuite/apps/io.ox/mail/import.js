define("io.ox/mail/import",["io.ox/core/extensions","io.ox/mail/api","io.ox/core/api/account","io.ox/core/tk/upload","io.ox/core/dropzone","io.ox/core/notifications","gettext!io.ox/mail"],function(e,o,i,r,t,n,l){"use strict";e.point("io.ox/mail/mediator").extend({id:"import-eml",index:1e12,setup:function(e){if(!1!==e.settings.get("features/importEML")){var s=e.getWindow();e.queues={importEML:r.createQueue({start:function(){s.busy()},progress:function(e){return o.importEML({file:e.file,folder:e.options.folder}).done(function(o){var i=_(o.data||[]).first()||{};e.response=i,"Error"in i?n.yell("error",i.Error):n.yell("success",l("Mail has been imported"))}).fail(n.yell)},stop:function(){s.idle()},type:"importEML"})};var a=new(t.Inplace.extend({isSupported:function(){return!i.isUnifiedFolder(e.folder.get())}}))({caption:l("Drop EML file here for import"),filter:/\.eml$/i});a.on({show:function(){e.right.removeClass("preview-visible"),e.listControl.$el.stop().hide()},hide:function(){e.listControl.$el.fadeIn("fast")},drop:function(o){e.queues.importEML.offer(o,{folder:e.folder.get()})},invalid:function(){n.yell("error",l("Mail was not imported. Only .eml files are supported."))}}),e.left.append(a.render().$el.addClass("abs"))}}})});