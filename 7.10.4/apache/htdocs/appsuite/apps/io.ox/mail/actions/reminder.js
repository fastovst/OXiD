define("io.ox/mail/actions/reminder",["gettext!io.ox/mail","io.ox/mail/util","settings!io.ox/core","io.ox/core/notifications"],function(e,t,o,a){"use strict";return function(r){var n=[].concat(r.data)[0];require(["io.ox/backbone/views/modal","io.ox/tasks/api","io.ox/tasks/util"],function(r,i,l){var c,s,d,u=new Date;new r({title:e("Remind me"),help:"ox.appsuite.user.sect.email.manage.reminder.html"}).addCancelButton().addButton({label:e("Create reminder"),action:"create"}).build(function(){var o;this.$body.append($('<div class="form-group">').append($("<label>").attr("for",o=_.uniqueId("form-control-label-")).text(e("Subject")),c=$('<input type="text" class="form-control">').attr("id",o).val(e("Mail reminder")+": "+n.subject).focus(function(){this.select()})),$('<div class="form-group">').append($("<label>").attr("for",o=_.uniqueId("form-control-label-")).text(e("Note")),s=$('<textarea class="form-control" rows="5">').attr("id",o).val(e("Mail reminder for")+": "+n.subject+" \n"+e("From")+": "+t.formatSender(n.from[0]))),$('<div class="form-group">').append($("<label>").attr("for",o=_.uniqueId("form-control-label-")).text(e("Remind me")),d=$('<select class="form-control" name="dateselect">').attr("id",o).append(l.buildDropdownMenu({time:u}))))}).on("create",function(){var t,r=l.computePopupTime(d.val(),!0);t=s.val()+"\n--\nmail://"+_.ecid(n),i.create({title:c.val(),folder_id:o.get("folder/tasks"),alarm:r.alarmDate,note:t,status:1,recurrence_type:0,percent_completed:0}).done(function(){a.yell("success",e("Reminder has been created"))})}).open()})}});