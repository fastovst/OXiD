define("io.ox/mail/compose/checks",["io.ox/mail/api","io.ox/mail/util","io.ox/backbone/views/modal","settings!io.ox/mail","gettext!io.ox/mail"],function(e,i,t,n,l){function r(e){if(!e)return null;var i=a(e.headers);return i||(_.isEmpty(e.from)?null:e.from[0])}function a(e){if(!e)return null;var t=$.trim(e["Reply-To"]);return t?i.parseRecipient(t):null}function o(e){return e&&e.headers&&_.isString(e.headers["List-Post"])?e.headers["List-Post"].replace(/^.*<mailto:(.+)>.*$/i,"$1").toLowerCase():""}return{isMailingList:function(e){if(!e||!e.headers)return!1;for(var i in e.headers)if(/^list-(id|archive|owner)$/i.test(i))return!0;return!1},replyToMailingList:function(a,s){if(!n.get("confirmReplyToMailingLists",!0))return $.when(s);var u=e.pool.get("detail").get(a);if(!u)return $.when(s);if(!this.isMailingList(u.toJSON()))return $.when(s);var p=r(u.toJSON());if(!p)return $.when(s);var c=$.Deferred(),f="<b>"+_.escape(o(u.toJSON()))+"</b>",d="<b>"+_.escape(i.getDisplayName(p,{showMailAddress:!0}))+"</b>";return new t({title:l("Reply to mailing list"),easyOut:!1,description:[$("<p>").html(f?l("This message was sent via the mailing list %1$s.",f):l("This message was sent via a mailing list.")),$("<p>").html(l("Do you really want to reply all or just %1$s?",d))]}).addCancelButton({left:!0}).addButton({label:l("Reply all"),action:"reply-all"}).addButton({label:l("Reply to sender"),action:"reply"}).on("reply-all",function(){c.resolve("replyall")}).on("reply",function(){c.resolve("reply")}).on("cancel",function(){c.reject()}).open(),c}}});