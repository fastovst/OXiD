define("io.ox/mail/mailfilter/autoforward/view",["io.ox/mail/mailfilter/autoforward/model","io.ox/backbone/views/modal","io.ox/backbone/mini-views","io.ox/core/settings/util","io.ox/core/extensions","io.ox/core/yell","gettext!io.ox/mail","less!io.ox/mail/mailfilter/vacationnotice/style"],function(e,t,i,o,n,a,d){"use strict";function s(e){throw a("error",d("MAIL_FILTER-0015"===e.code?"Unable to load mail filter settings.":"Unable to load your auto forward settings. Please retry later.")),e}function l(e){return new t({async:!0,focus:'input[name="active"]',model:e.model,point:c,title:d("Auto forward"),help:"ox.appsuite.user.sect.email.send.autoforward.html",width:640}).inject({updateActive:function(){var e=this.model.get("active");this.$body.toggleClass("disabled",!e).find(":input").prop("disabled",!e)},manageSaveButton:function(){function e(){$(t).attr("disabled",""===$(i).val().trim()&&!o.model.get("id")||""===$(i).val().trim()&&o.model.get("active"))}var t=_.first(this.$footer.find('[data-action="save"]')),i=_.first(this.$body.find('input[name="to"]')),o=this;""!==$(i).val().trim()||this.model.get("active")||$(t).attr("disabled",!0),$(i).on("keyup",function(){e()}),this.model.on("change:active",function(){e()})}}).build(function(){this.data=e,this.$el.addClass("rule-dialog")}).addCancelButton().addButton({label:d("Apply changes"),action:"save"}).on("open",function(){this.updateActive(),this.manageSaveButton()}).on("save",function(){this.model.save().done(this.close).fail(this.idle).fail(a)}).open()}function r(){var t=new e;return t.fetch().then(function(){return{model:t}})}var c="io.ox/mail/auto-forward/edit",u=0;return n.point(c).extend({index:u+=100,id:"switch",render:function(){this.$header.prepend(new i.SwitchView({name:"active",model:this.model,label:"",size:"large"}).render().$el.attr("title",d("Enable or disable auto forward"))),this.listenTo(this.model,"change:active",this.updateActive)}},{index:u+=100,id:"to",render:function(){this.$body.append(o.input("to",d("Forward all incoming emails to this address"),this.model))}},{index:u+=100,id:"copy",render:function(){this.$body.append(o.checkbox("copy",d("Keep a copy of the message"),this.model))}},{index:u+=100,id:"stop",render:function(){this.$body.append(o.checkbox("processSub",d("Process subsequent rules"),this.model))}}),{open:function(){return r().then(l,s)}}});