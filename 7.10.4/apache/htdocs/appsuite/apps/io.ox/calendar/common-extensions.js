define("io.ox/calendar/common-extensions",["io.ox/core/extensions","io.ox/core/folder/api","io.ox/core/api/user","io.ox/core/util","io.ox/calendar/util","gettext!io.ox/calendar"],function(a,e,t,d,n,i){"use strict";function r(a,e){e=e||{};var t=a.data.event||a.data,n=_.isUndefined(t.summary)?i("Private"):t.summary||" ";return e.parse&&(n=d.urlify(n)),n}return{title:function(a){this.append($('<div class="title">').text(r(a)))},h1:function(a){this.append($('<h1 class="subject clear-title">').append(r(a,{parse:!0})))},h2:function(a){this.append($('<h2 class="subject">').text(r(a)))},interval:function(e){var t=$("<div>");a.point("io.ox/calendar/detail/date").invoke("draw",t,e),this.append($('<span class="interval">').append(t.find(".interval").html()))},day:function(e){var t=$("<div>");a.point("io.ox/calendar/detail/date").invoke("draw",t,e),this.append($('<span class="day">').append(t.find(".day").html()))},location:function(a){this.append($('<span class="location">').text(a.data.location))},locationDetail:function(a){a.data.location&&this.append($('<div class="location">').append(d.urlify(a.data.location).replace(/\n/g,"<br>")))},time:function(a){this.append($('<div class="time">').text(n.getTimeInterval(a.data)))},dateSimple:function(a){this.append($('<div class="date">').text(n.getDateInterval(a.data)))},datetime:function(a){var e=a.data.event||a.data;this.append(n.getDateTimeIntervalMarkup(e,{zone:moment().tz(),noTimezoneLabel:!0}))},date:function(a,e){this.append(n.getDateTimeIntervalMarkup(a.data,e))},recurrence:function(a){var e=n.getRecurrenceString(a.recurrenceMaster||a.model||a.data);""!==e&&this.append($('<div class="recurrence">').text(e))},privateFlag:function(a){if(n.isPrivate(a.data)){var e=i(n.isPrivate(a.data,!0)?"Secret":"Private"),t=$('<i class="fa private-flag" aria-hidden="true" data-animation="false">');this.append(n.isPrivate(a.data,!0)?t.addClass("fa-user-circle"):t.addClass("fa-lock").attr("title",e).tooltip(),$('<span class="sr-only">').text(e))}},additionalFlags:function(a){if(!_.isEmpty(n.returnIconsByType(a.data).property)){var e=$('<div class="flags">');this.append(e.append(n.returnIconsByType(a.data).property))}},note:function(a){a.data.description&&this.append($('<div class="note">').html(n.getNote(a.data)))},detail:function(t,d){var r=t.data,o=d.minimaldata?{}:e.pool.getModel(r.folder);if(!n.isPrivate(r)||(r.createdBy||{}).entity===ox.user_id||e.is("private",o)){var s=$('<table class="details-table expandable-content">');a.point("io.ox/calendar/detail/details").invoke("draw",s,t,d),this.append($('<fieldset class="details expandable">').append($('<legend class="io-ox-label">').append($('<a href="#" class="expandable-toggle" role="button" aria-expanded="false">').append($("<h2>").text(i("Details"))),$.txt(" "),$('<i class="fa expandable-indicator" aria-hidden="true">')),s).addClass(d.minimaldata?"open":""))}},organizer:function(a){a.data.organizer&&this.append($("<tr>").append($("<th>").text(i("Organizer")),$('<td class="detail organizer">').append(d.renderPersonalName({$el:a.organizerNode,name:a.data.organizer.cn,email:a.data.organizer.email,user_id:a.data.organizer.entity},a.data))))},sentBy:function(a){if(a.data.organizer&&a.data.organizer.sentBy){var e=a.data.organizer.sentBy;this.append($("<tr>").append($("<th>").text(i("Sent by")),$('<td class="detail sendby">').append(d.renderPersonalName({$el:a.sendbyNode,name:e.cn,email:e.email,user_id:e.entity},a.data))))}},noHalos:function(){this.find("*").removeClass("halo-link")},shownAs:function(a){n.hasFlag(a.model||a.data,"transparent")&&this.append($("<tr>").append($("<th>").text(i("Shown as")),$("<td>").append(n.getShownAs(a.model||a.data))))},folder:function(a){a.data.folder&&this.append($("<tr>").append($("<th>").text(i("Calendar")),$("<td>").attr("data-folder",a.data.folder).append(e.getTextNode(a.data.folder))))},created:function(a){if(a.data.created||a.data.createdBy){var e=(a.data.createdBy||{}).entity;this.append($("<tr>").append($("<th>").text(i("Created")),$('<td class="created">').append(a.data.created?[$("<span>").text(n.getDate(a.data.created)),$("<span>").text(" – ")]:[],a.data.createdBy?d.renderPersonalName({html:t.getTextNode(e),user_id:e},a.data):[])))}},modified:function(a){(a.data.lastModified||a.data.modifiedBy)&&this.append($("<tr>").append($("<th>").text(i("Modified")),$('<td class="modified">').append(a.data.lastModified?[$("<span>").text(n.getDate(a.data.lastModified))]:[],a.data.lastModified&&a.data.modifiedBy?$("<span>").text(" – "):[],a.data.modifiedBy?d.renderPersonalName({html:t.getTextNode(a.data.modifiedBy.entity),user_id:a.data.modifiedBy.entity},a.data):[])))}}});